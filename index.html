<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Keep It Simple Stupid" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="深自缄默，如云漂泊">
<meta property="og:type" content="website">
<meta property="og:title" content="OrangeLuyao的小站">
<meta property="og:url" content="https://GeekOrangeLuyao.github.io/index.html">
<meta property="og:site_name" content="OrangeLuyao的小站">
<meta property="og:description" content="深自缄默，如云漂泊">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="OrangeLuyao的小站">
<meta name="twitter:description" content="深自缄默，如云漂泊">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"hide","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://GeekOrangeLuyao.github.io/"/>





  <title>OrangeLuyao的小站</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    
      <div class="site-meta-headline">
        <a>
          <img class="custom-logo-image" src="/images/aaa.jpg"
               alt="OrangeLuyao的小站"/>
        </a>
      </div>
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">OrangeLuyao的小站</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">The world is a fine place, and worth fighting for.I agree with the second part.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GeekOrangeLuyao.github.io/src/uncategorized/Speech-and-Language-Processing-笔记-之-Ngram/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="OrangeLuYao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="OrangeLuyao的小站">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/src/uncategorized/Speech-and-Language-Processing-笔记-之-Ngram/" itemprop="url">Speech and Language Processing 笔记 之 Ngram</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-21T20:49:48+08:00">
                2018-10-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>[TOC]</p>
<h1 id="Speech-and-Language-Processing-笔记之-Ngram"><a href="#Speech-and-Language-Processing-笔记之-Ngram" class="headerlink" title="Speech and Language Processing 笔记之 Ngram"></a>Speech and Language Processing 笔记之 Ngram</h1><blockquote>
<p>单纯的只是列出一些要点</p>
</blockquote>
<h2 id="4-N-grams"><a href="#4-N-grams" class="headerlink" title="4. N-grams"></a>4. N-grams</h2><blockquote>
<p>We formalize this idea of word prediction with probabilistic WORD PREDICTION models called N-gram models, which predict the next word from the previous N −1N -GRAM MODELS words. Such statistical models of word sequences are also called language models or LANGUAGE MODELS LMs. Computing the probability of the next word will turn out to be closely related LMs to computing the probability of a sequence of words</p>
</blockquote>
<p>N-grams 在机器翻译中也可以发挥一定的作用，比如可以在几个待选的翻译中进行验证。除此之外，单词拼写等等问题也可以归结到这个问题中间解决。</p>
<p>Besides these sample areas, N-grams are also crucial in NLP tasks like part-ofspeech tagging, natural language generation, and word similarity, as well as in applications from authorship identiﬁcation and sentiment extraction to predictive text input systems for cell phones</p>
<h3 id="4-1-COUNTING-WORDS-IN-CORPORA"><a href="#4-1-COUNTING-WORDS-IN-CORPORA" class="headerlink" title="4.1   COUNTING WORDS IN CORPORA"></a>4.1   COUNTING WORDS IN CORPORA</h3><blockquote>
<p>corpus 语料库  (plural corpora) an on-line collection of text or speech.<br>两个经典的语料库 Brown and Switchboard<br>punctuation 标点符号</p>
</blockquote>
<p>下面是语料中的一些说明：</p>
<ol>
<li>标点符号是是否被记录需要根据情况</li>
</ol>
<blockquote>
<p>disﬂuencies 不流利(怎么感觉没这个词啊)</p>
</blockquote>
<ol>
<li>有一些碎片和语气填充词<br>语气词的使用往往可以用于表征人的内心想法，比如疑虑等等。有些时候甚至会提高next prediction的成功率</li>
<li>首字母不同的情况下一般认为是一个词，但是也有特殊情况</li>
<li>单复数的问题使用word-form解释了一波，应该是只要表达的意思没有区别就一致</li>
</ol>
<p>As we can see, N-gram models, and counting words in general, requires that we do the kind of tokenization or text normalization that we introduced in the previous chapter: separating out punctuation, dealing with abbreviations like m.p.h., normalizing spelling, and so on. </p>
<blockquote>
<p>types 语料库中的单词个数 V<br>tokens 正在使用的单词个数 N<br>boldface forms<br>一般有$V &gt; \sqrt{N}$</p>
</blockquote>
<h3 id="4-2-SIMPLE-UNSMOOTHED-N-GRAMS"><a href="#4-2-SIMPLE-UNSMOOTHED-N-GRAMS" class="headerlink" title="4.2 SIMPLE (UNSMOOTHED) N-GRAMS"></a>4.2 SIMPLE (UNSMOOTHED) N-GRAMS</h3><p>We assume that the reader has acquired some very basic background in probability theory. Our goal is to compute the probability of a word w given some history h, or P(w|h).<br>Suppose the history h is “its water is so transparent that” and we want to know the probability that the next word is the:<br>$$P(the|its water is so transparent that)$$</p>
<p> One way is to estimate it from relative frequency counts:</p>
<ol>
<li>For example, we could take a very large corpus, count the number of times we see the water is so transparent that, and count the number of times this is followed by the.</li>
</ol>
<p>也就是直接硬算<br>$$ P(the|its water is so transparent that) = \frac {C(its water is so transparent that the)}{ C(its water is so transparent that) }$$<br>With a large enough corpus, such as the web, we can compute these counts, and estimate the probability from Equation<br>但是数据集显然不可能足够完成这个结果</p>
<p>For this reason, we’ll need to introduce cleverer ways of estimating the probability of a word w given a history h, or the probability of an entire word sequence W.</p>
<p>注意表示一个$w_1…w_n$是使用$w_1^n$<br>因此对于一个句子是:<br>$$P(w_1^n) = P(w_1) P(w_2 | w_1) … P(w_n|w_1^{n-1})$$<br>We don’t know any way to compute the exact probability of a word given a long sequence of preceding words, $P(w_n|w^{n-1}_1)$.<br>为了避免搜索整个句子太大了，所以认为一个词只与前面几个词有关系</p>
<p>其中bi-gram表示只用前面一个词（binary），这个时候我们认为$P(w|w_1^{n-1}) =    P(w<em>n | w</em>{n-1})$<br>这就是Markov 假设（数学之美啥的都看过了）</p>
<blockquote>
<p>This assumption that the probability of a word depends only on the previous word is called a Markov assumption. Markov models are the class of probabilistic models MARKOV that assume that we can predict the probability of some future unit without looking too far into the past. We can generalize the bi-gram</p>
</blockquote>
<p>转化之后的问题就变成了:<br>How do we estimate these bi-gram or N-gram probabilities? The simplest and most intuitive way to estimate probabilities is called Maximum Likelihood Estimation, or MLE. </p>
<p>We get the MLE estimate for the parameters of an N-gram model by taking MLE counts from a corpus, and normalizing them so they lie between 0 and 1.</p>
<blockquote>
<p><strong>Orange按：Markov 问题部分解决了词汇搭配的结果，但是组成句子是否可以结合一些知识系统的方法？还是说全局使用词汇搭配？</strong></p>
</blockquote>
<p>所以概率改为<br>$$P(w<em>n|w</em>{n−1}) = \frac{C(w_{n−1}w<em>n)} {\sum{C(w</em>{n−1}w)}}$$<br>因为只要有$w_{n-1}$就认为有后面的值(基本如此，对于一个文本而言，只有少数没有，后面增加前后的标记这样就几乎不会有这个问题)<br>因此求和就可以转化成直接数个数(事实上可以预见的是如果不是bi-gram而是使用的多个词向后预测的求和都是这样的结果)</p>
<p>也就是有：<br>$$P(w<em>n|w</em>{n−N+1}^{n-1}) = \frac{C(w_{n−N+1}^{n-1}w<em>n)} {\sum{C(</em>{n−N+1}^{n-1}w)}}$$</p>
<p>这种利用个数进行估计的也就是最大似然估计</p>
<blockquote>
<p> Maximum Likelihood Estimation or MLE 最大似然估计</p>
</blockquote>
<p>但是最大似然估计显然是对于某个语料库这样看的</p>
<blockquote>
<p>Although we will generally show bi-gram models in this chapter for pedagogical purposes, note that when there is sufﬁcient training data we are more likely to use tri-gram models, which condition on the previous two words rather than the previous TRI-GRAM word. To compute tri-gram probabilities at the very beginning of sentence, we can use two pseudo-words for the ﬁrst trigram.</p>
</blockquote>
<p>有的时候也是用三个单词的</p>
<h3 id="4-3-TRAINING-AND-TEST-SETS"><a href="#4-3-TRAINING-AND-TEST-SETS" class="headerlink" title="4.3 TRAINING AND TEST SETS"></a>4.3 TRAINING AND TEST SETS</h3><p>讲了一些train - test 的数据集划分的问题，没啥意思</p>
<blockquote>
<p>There is is a useful metric for how well a given statistical model matches a test corpus, called perplexity<br>注意测试数据不能包含在训练数据中</p>
</blockquote>
<p>In addition to training and test sets, other divisions of data are often useful.</p>
<blockquote>
<p>a held-out set  存留数据 主要用于训练一些额外的数据 详情参见4.6节</p>
</blockquote>
<p>有的时候需要预留出多个数据集</p>
<h4 id="4-3-1-N-gram-Sensitivity-to-the-Training-Corpus"><a href="#4-3-1-N-gram-Sensitivity-to-the-Training-Corpus" class="headerlink" title="4.3.1 N-gram Sensitivity to the Training Corpus"></a>4.3.1 N-gram Sensitivity to the Training Corpus</h4><blockquote>
<p>coherent 流利</p>
</blockquote>
<p>The N-gram model, like many statistical models, is very dependent on the training corpus.<br>对于 unigram 的情况，就是直接随机进行列举，列举的依据只是训练集的词的频率。</p>
<p>后面作者统计了莎士比亚的一个corpus</p>
<p>Recent research has also studied ways to dynamically adapt language models to different genres;<br>最近也有研究对于如何得到在不同数据集上都可以动态适应的语言模型</p>
<h4 id="4-3-2-Unknown-Words-Open-versus-closed-vocabulary-tasks"><a href="#4-3-2-Unknown-Words-Open-versus-closed-vocabulary-tasks" class="headerlink" title="4.3.2 Unknown Words: Open versus closed vocabulary tasks"></a>4.3.2 Unknown Words: Open versus closed vocabulary tasks</h4><blockquote>
<p>lexicon 词典</p>
</blockquote>
<p>The closed vocabulary assumption is the assumption that we have such a lexicon, and that the test set can only contain words from this lexicon.<br>We call these unseen events unknown words, or out of vocabulary (OOV) words.<br>The percentage of OOV words that appear in the test set is called the OOV rate. </p>
<p>An open vocabulary system is one where we model these potential unknown words in the test set by adding a pseudoword called <code>&lt;UNK&gt;</code>. We can train the probabilities of the unknown word model <code>&lt;UNK&gt;</code> as follows:</p>
<ol>
<li>Choose a vocabulary (word list) which is ﬁxed in advance.</li>
<li>Convert in the training set any word that is not in this set (any OOV word) to the unknown word token <code>&lt;UNK&gt;</code> in a text normalization step.</li>
<li>Estimate the probabilities for <code>&lt;UNK&gt;</code> from its counts just like any other regular word in the training set.</li>
</ol>
<h3 id="4-4-EVALUATING-N-GRAMS-PERPLEXITY"><a href="#4-4-EVALUATING-N-GRAMS-PERPLEXITY" class="headerlink" title="4.4 EVALUATING N-GRAMS: PERPLEXITY"></a>4.4 EVALUATING N-GRAMS: PERPLEXITY</h3><p>The best way to evaluate the performance of a language model is to embed it in an application and measure the total performance of the application. Such end-to-end evaluation is called extrinsic evaluation, and also sometimes called in vivo evaluation (Sparck Jones and Galliers, 1996).</p>
<p>end-to-end evaluation is often very expensive</p>
<p><strong>Perplexity</strong> is the most common intrinsic evaluation metric for N-gram language models.<br>The intuition of perplexity is that given two probabilistic models, the better model is the one that has a tighter ﬁt to the test data, or predicts the details of the test data better. </p>
<p> the perplexity (sometimes called PP for short)</p>
<p>定义：<br>$$PP(w) = P(w1…w_n)^{-\frac{1}{N}} = \sqrt[N]{\frac{1}{P(w_1…w_n)}}$$</p>
<p>在使用链式法则的情况下，对于bi-gram的结果显然是：</p>
<p>$$PP(W) = \sqrt[N]{\prod_{i=1}^N \frac{1}{p(w<em>i|w</em>{i-1})}}$$</p>
<p>显然有越高的状态可能性，其PP值越低<br>There is another way to think about perplexity: as the weighted average branching factor(加权平均分支系数) of a language.<br>The branching factor of a language is the number of possible next words that can follow any word.</p>
<p>Perplexity可以认为是average branch factor（平均分支系数），即预测下一个词时可以有多少种选择。别人在作报告时说模型的PPL下降到90，可以直观地理解为，在模型生成一句话时下一个词有90个合理选择，可选词数越少，我们大致认为模型越准确。这样也能解释，为什么PPL越小，模型越好。</p>
<p>perplexity is also closely related to the information theoretic notion of entropy.<br>使用closed vocabulary可以非常好的降低pp。</p>
<p>In general, the perplexity of two language models is only comparable if they use the same vocabulary.</p>
<h2 id="4-5-SMOOTHING"><a href="#4-5-SMOOTHING" class="headerlink" title="4.5 SMOOTHING"></a>4.5 SMOOTHING</h2><p>注意到我们现在的主要问题在于 使用似然来训练我们的模型参数，但是当数据稀疏的时候就显得力不从心了。</p>
<p>We need a method which can help get better estimates for these zero or low frequency counts.<br>为了解决这种几乎统计不到的情况，我们使用smoothing </p>
<blockquote>
<p>这时的解决办法，我们称之为“平滑技术”（Smoothing）或者 “减值” （Discounting）。其主要策略是把在训练样本中出现过的事件的概率适当减小，然后把减小得到的概率密度分配给训练语料中没有出现过的事件。</p>
</blockquote>
<h3 id="4-5-1-Laplace-Smoothing"><a href="#4-5-1-Laplace-Smoothing" class="headerlink" title="4.5.1 Laplace Smoothing"></a>4.5.1 Laplace Smoothing</h3><p>既然是有些没有出现，那么直接在所有的词默认从一开始统计，也就是说直接在所有的个数统计上加上1，这样的话最后smooth之后的概率就是：<br>$$P_{Laplace} = \frac{c_i + 1}{N+V}$$<br>显然有其中的V就是词汇量<br>训练语料中未出现的n-Gram的概率不再为 0，而是一个大于 0 的较小的概率值。Add-one 平滑算法确实解决了我们的问题，但显然它也并不完美。由于训练语料中未出现n-Gram数量太多，平滑后，所有未出现的n-Gram占据了整个概率分布中的一个很大的比例。因此，在NLP中，Add-one给训练语料中没有出现过的 n-Gram 分配了太多的概率空间。此外，认为所有未出现的n-Gram概率相等是否合理其实也值得商榷。而且，对于出现在训练语料中的那些n-Gram，都增加同样的频度值，这是否欠妥，我们并不能给出一个明确的答案。</p>
<p><a href="https://blog.csdn.net/baimafujinji/article/details/51297802" target="_blank" rel="external">Smoothing 算法博客</a></p>
<h3 id="4-5-2-Good-Turing-Discounting"><a href="#4-5-2-Good-Turing-Discounting" class="headerlink" title="4.5.2 Good Turing Discounting"></a>4.5.2 Good Turing Discounting</h3><blockquote>
<p>整体的思想依然是基于“劫富济贫”的思想，也就是说把非0事件的概率按照公式消减出现的次数，然后把剩余的概率均匀分给0概率事件。</p>
</blockquote>
<p>所谓discounting 算法就是使用已经出现过的数量来帮助估计未出现过的情况。<br>A word or N-gram (or any event) that occurs once is called a singleton, or a hapax legomenon. The Good-Turing intuition is to use the frequency of singletons as a re-estimate of the frequency of zero-count bigrams.<br>用$N_c$来表示出现c次的单词<br><a href="https://blog.csdn.net/u011415481/article/details/51156150?utm_source=blogxgwz9" target="_blank" rel="external">G-T Discounting 一个比较好的解释</a></p>
<h3 id="4-5-3-Some-advanced-issues-in-Good-Turing-estimation"><a href="#4-5-3-Some-advanced-issues-in-Good-Turing-estimation" class="headerlink" title="4.5.3 Some advanced issues in Good-Turing estimation"></a>4.5.3 Some advanced issues in Good-Turing estimation</h3><p>Good-Turing的变体：Simple Good-Turing<br>使用$log(N_c) = a + blog(c) $来进行代替<br>同时设置阈值k<br>当c &gt; k的时候 $c^<em> = c$<br>否则<br>$$c^</em> = \frac{(c+1)\frac{N_c+1}{N<em>c} - c\frac{(k+1)N</em>{k+1}}{N<em>1}}{1 - \frac{(k+1)N</em>{k+1}}{N_1}}$$</p>
<blockquote>
<p>It turns out that Good-Turing discounting is not used by itself in discounting Ngrams; it is only used in combination with the backoff and interpolation algorithms described in the next sections.</p>
</blockquote>
<h3 id="4-6-INTERPOLATION"><a href="#4-6-INTERPOLATION" class="headerlink" title="4.6 INTERPOLATION"></a>4.6 INTERPOLATION</h3><p>设想对于一个trigram的模型，我们要统计语料库中 “like chinese food” 出现的次数，结果发现它没出现过，则计数为0。在回退策略中，将会试着用低阶gram来进行替代，也就是用 “chinese food” 出现的次数来替代。</p>
<p>实际上，插值和回退两个都是使用这种思想。</p>
<p>对于插值来说：<br>$$P(w<em>n | w</em>{n-1}w_{n-2}) = \lambda_1P(w<em>n | w</em>{n-1}w_{n-2}) + \lambda_2P(w<em>n|w</em>{n-1}) + \lambda_3P(w_n)$$</p>
<p>同时有：<br>$$\sum_{i}\lambda_i = 1$$</p>
<p>How are these λ values set? Both the simple interpolation and conditional interpolation λs are learned from a held-out corpus.<br>可以根据试验凭经验设定，也可以通过应用某些算法确定，例如EM算法。</p>
<p>在简单单线形插值法中，权值$λ_i$是常量。显然，它的问题在于不管高阶模型的估计是否可靠（毕竟有些时候高阶的Gram计数可能并无为 0），低阶模型均以同样的权重被加入模型，这并不合理。一个可以想到的解决办法是让 $λ_i$ 成为历史的函数。这个方法被称为Jelinek-Mercer Smoothing</p>
<h3 id="4-7-BACKOFF-回退"><a href="#4-7-BACKOFF-回退" class="headerlink" title="4.7 BACKOFF(回退)"></a>4.7 BACKOFF(回退)</h3><p>The version of backoff that we describe uses Good-Turing discounting as well. It was introduced by Katz (1987), hence this kind of backoff with discounting is also called Katz backoff.<br>通常我们会认为高阶模型更加可靠，我们之前博文中给出的例子也表明，当能够获知更多历史信息时，其实就获得了当前推测的更多约束，这样就更容易得出正确的结论。所以在高阶模型可靠时，尽可能的使用高阶模型。但是有时候高级模型的计数结果可能为0，这时我们就转而使用低阶模型来避免稀疏数据的问题。</p>
<p>也就是有：<br>$$P_{katz}(w<em>n |w^{n-1}</em>{n - N + 1}) = f(x)=\left{\begin{aligned}P^*(w<em>N |w</em>{n - N +1}^{n-1})   &amp; &amp;{if C(w<em>{n-N+1}^n) &gt; 0} \\alpha(w</em>{n-N+1}^{n-1})P_{katz}(w<em>n | w</em>{n-N+1}^{n-1}) &amp; &amp;{otherwise}\end{aligned}\right.$$<br>这显然是一个递归的过程</p>
<p>对于$P^*(.)$有更好的求法和其他的优化，这里不赘述了。</p>
<h3 id="4-8-PRACTICAL-ISSUES-TOOLKITS-AND-DATA-FORMATS"><a href="#4-8-PRACTICAL-ISSUES-TOOLKITS-AND-DATA-FORMATS" class="headerlink" title="4.8 PRACTICAL ISSUES: TOOLKITS AND DATA FORMATS"></a>4.8 PRACTICAL ISSUES: TOOLKITS AND DATA FORMATS</h3><p>这里主要是说一些实验过程的一些注意点，这里不赘述了</p>
<h3 id="4-9-ADVANCED-ISSUES-IN-LANGUAGE-MODELING"><a href="#4-9-ADVANCED-ISSUES-IN-LANGUAGE-MODELING" class="headerlink" title="4.9 ADVANCED ISSUES IN LANGUAGE MODELING"></a>4.9 ADVANCED ISSUES IN LANGUAGE MODELING</h3><h4 id="4-9-1-Advanced-Smoothing-Methods-Kneser-Ney-Smoothing"><a href="#4-9-1-Advanced-Smoothing-Methods-Kneser-Ney-Smoothing" class="headerlink" title="4.9.1 Advanced Smoothing Methods: Kneser-Ney Smoothing"></a>4.9.1 Advanced Smoothing Methods: Kneser-Ney Smoothing</h4><p>在介绍Kneser-Ney Smoothing之前，首先介绍Absolute Discounting 方法<br>之前add-one(laplace) 方法本质上说就是预留出一部分概率交给未出现的情况，那么为什么不直接对于已经进行统计的数据进行适当的减少呢。所谓的absolute 这个绝对就是在每次的统计中都会减少一个绝对值d，这样修正之后：<br>$$P_{absolute}(w<em>i | w</em>{i-1}) = \left{\begin{aligned}\frac{C(w_{I-1}w<em>i) - D}{C(w</em>{i-1})}  &amp; &amp;{if C(w_{i-1}w_i) &gt; 0} \\alpha(w<em>i)P</em>{absolute}(w_i) &amp; &amp;{otherwise} \end{aligned}\right.$$<br>当然在实际情况中，我们也会保持$d \in [0,1]$</p>
<p>下面我们介绍<strong>Kneser-Key discounting</strong><br>假设我们使用 bigram 和 unigram 的插值模型来预测下面这个句子中空缺的一个词该填什么</p>
<blockquote>
<p> I used to eat Chinese food with ______ instead of knife and fork.</p>
</blockquote>
<p>直觉上你一定能猜到这个地方应该填 chopsticks（筷子）。但是有一种情况是训练语料库中，Zealand 这个词出现的频率非常高，因为 New Zealand 是语料库中高频词。如果你采用标准的 unigram 模型，那么显然 Zealand 会比 chopsticks 具有更高的权重，所以最终计算机会选择Zealand这个词（而非chopsticks）填入上面的空格，尽管这个结果看起来相当不合理。这其实就暗示我们应该调整一下策略，最好仅当前一个词是 New 时，我们才给 Zealand 赋一个较高的权值，否则尽管在语料库中 Zealand 也是高频词，但我们并不打算单独使用它。</p>
<h4 id="4-9-2-Class-based-N-grams"><a href="#4-9-2-Class-based-N-grams" class="headerlink" title="4.9.2 Class-based N-grams"></a>4.9.2 Class-based N-grams</h4><p>Class-Based N-grams，又被称为Cluster N-grams，是一种基于词的类别信息或族信息的N-gram变体。它针对训练语料的稀疏性特征可以起到良好的效果。比方说针对一个航班预定系统，我们希望预测“到上海”的bi-gram概率，但是“到上海”从来没有出现在训练预料中。但是我们的训练语料中有“到北京”、“到长沙”、“到深圳”。如果我们知道它们都是城市，并且假设“上海”在其他上下文语料中有出现，那么我么可以预测出“从”后面跟城市名的可能性。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GeekOrangeLuyao.github.io/src/uncategorized/Linear-Model/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="OrangeLuYao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="OrangeLuyao的小站">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/src/uncategorized/Linear-Model/" itemprop="url">Linear Model</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-09T14:26:00+08:00">
                2018-10-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="机器学习-——-线性模型"><a href="#机器学习-——-线性模型" class="headerlink" title="机器学习 —— 线性模型"></a>机器学习 —— 线性模型</h1><h2 id="1-西瓜数据集"><a href="#1-西瓜数据集" class="headerlink" title="1. 西瓜数据集"></a>1. 西瓜数据集</h2>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GeekOrangeLuyao.github.io/src/uncategorized/vscode-build-cpp-configure/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="OrangeLuYao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="OrangeLuyao的小站">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/src/uncategorized/vscode-build-cpp-configure/" itemprop="url">vscode build cpp configure</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-17T17:22:03+08:00">
                2018-06-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ubuntu-下如何使用-vscode-编译-cpp"><a href="#ubuntu-下如何使用-vscode-编译-cpp" class="headerlink" title="ubuntu 下如何使用 vscode 编译 cpp"></a>ubuntu 下如何使用 vscode 编译 cpp</h1><h2 id="1-安装C-CPP-插件"><a href="#1-安装C-CPP-插件" class="headerlink" title="1. 安装C/CPP 插件"></a>1. 安装C/CPP 插件</h2><p>首先安装vscode的c/cpp插件，网址<br><a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools" target="_blank" rel="external">cpp for vscode</a></p>
<h2 id="2-配置launch-js"><a href="#2-配置launch-js" class="headerlink" title="2. 配置launch.js"></a>2. 配置launch.js</h2><p>在配置之前，首先介绍下vscode 所具有的一些配置所需要的常数<br><a href="https://code.visualstudio.com/docs/editor/variables-reference" target="_blank" rel="external">val ref</a></p>
<p>具体如下：</p>
<ul>
<li>${workspaceFolder} - the path of the folder opened in VS Code</li>
<li>${workspaceFolderBasename} - the name of the folder opened in VS Code without any slashes (/)</li>
<li>${file} - the current opened file</li>
<li>${relativeFile} - the current opened file relative to workspaceFolder</li>
<li>${fileBasename} - the current opened file’s basename</li>
<li>${fileBasenameNoExtension} - the current opened file’s basename with no file extension</li>
<li>${fileDirname} - the current opened file’s dirname</li>
<li>${fileExtname} - the current opened file’s extension</li>
<li>${cwd} - the task runner’s current working directory on startup</li>
<li>${lineNumber} - the current selected line number in the active file</li>
<li>${selectedText} - the current selected text in the active file</li>
</ul>
<p>你只需要自动生成一个gdb launch的配置，修改你需要运行的文件名即可，也就是<code>program</code>属性，我的配置是这样的：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line"><span class="string">"program"</span>: <span class="string">"$&#123;workspaceFolder&#125;/$&#123;fileBasenameNoExtension&#125;.out"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>除此之外，cpp需要提前编译，所以需要配置一个新的task来配置这个编译过程：</p>
<h2 id="3-tasks-js"><a href="#3-tasks-js" class="headerlink" title="3. tasks.js"></a>3. tasks.js</h2><p>使用<code>ctrl + shift + p</code>,输入tasks，就可以看到配置的选项，随后选择other选项<br>我的配置如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="string">"tasks"</span>: [</div><div class="line">        &#123;</div><div class="line">            <span class="string">"label"</span>: <span class="string">"build cpp"</span>,</div><div class="line">            <span class="string">"type"</span>: <span class="string">"shell"</span>,</div><div class="line">            <span class="string">"command"</span>: <span class="string">"g++"</span>,</div><div class="line">            <span class="string">"args"</span>: [</div><div class="line">                <span class="string">"-std=c++11"</span>,<span class="string">"-g"</span>,<span class="string">"$&#123;file&#125;"</span>,<span class="string">"-O3"</span>,<span class="string">"-Wall"</span>,<span class="string">"-o"</span>,<span class="string">"$&#123;fileBasenameNoExtension&#125;.out"</span></div><div class="line">            ]</div><div class="line">        &#125;</div><div class="line">    ]</div></pre></td></tr></table></figure></p>
<p>注意这个”-g”是必要的，详细原因参见g++ 的编译指令</p>
<h2 id="4-配置cpp-的运行环境"><a href="#4-配置cpp-的运行环境" class="headerlink" title="4. 配置cpp 的运行环境"></a>4. 配置cpp 的运行环境</h2><p>最后需要给出linux下cpp的环境配置，这里直接生成几乎不需要修改：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="string">"configurations"</span>: [</div><div class="line">        &#123;</div><div class="line">            <span class="string">"name"</span>: <span class="string">"Linux"</span>,</div><div class="line">            <span class="string">"browse"</span>: &#123;</div><div class="line">                <span class="string">"path"</span>: [</div><div class="line">                    <span class="string">"$&#123;workspaceFolder&#125;"</span></div><div class="line">                ],</div><div class="line">                <span class="string">"limitSymbolsToIncludedHeaders"</span>: <span class="literal">true</span></div><div class="line">            &#125;,</div><div class="line">            <span class="string">"includePath"</span>: [</div><div class="line">                <span class="string">"$&#123;workspaceFolder&#125;"</span></div><div class="line">            ],</div><div class="line">            <span class="string">"defines"</span>: [],</div><div class="line">            <span class="string">"compilerPath"</span>: <span class="string">"/usr/bin/clang"</span>,</div><div class="line">            <span class="string">"cStandard"</span>: <span class="string">"c11"</span>,</div><div class="line">            <span class="string">"cppStandard"</span>: <span class="string">"c++17"</span>,</div><div class="line">            <span class="string">"intelliSenseMode"</span>: <span class="string">"clang-x64"</span></div><div class="line">        &#125;</div><div class="line">    ],</div><div class="line">    <span class="string">"version"</span>: <span class="number">4</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GeekOrangeLuyao.github.io/src/uncategorized/Perceptron/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="OrangeLuYao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="OrangeLuyao的小站">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/src/uncategorized/Perceptron/" itemprop="url">Perceptron</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-21T23:28:30+08:00">
                2018-05-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>使用iris data的数据，具体的地址是:<br><a href="https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data" target="_blank" rel="external">iris data</a></p>
<p>最简单的二分类，直接给出代码，解释在注释中：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> data.iris <span class="keyword">as</span> iris</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"></div><div class="line"><span class="comment"># the rate of train / test </span></div><div class="line">TTR = <span class="number">0.6</span></div><div class="line"></div><div class="line"><span class="comment"># 对于数据进行编码，这次没有使用</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_data</span><span class="params">(train_data)</span>:</span></div><div class="line">    res = []</div><div class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> train_data:</div><div class="line">        <span class="keyword">if</span> item[<span class="number">4</span>] <span class="keyword">not</span> <span class="keyword">in</span> res:</div><div class="line">            res.append(item[<span class="number">4</span>])</div><div class="line"></div><div class="line">    ans = []</div><div class="line">    cnt = <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> res:</div><div class="line">        ans.append(&#123;</div><div class="line">            <span class="string">"name"</span>: item,</div><div class="line">            <span class="string">"num"</span>: cnt</div><div class="line">        &#125;)</div><div class="line">        cnt += <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="keyword">return</span> ans</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Perception</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">        eta: 学习率</div><div class="line">        vector_n: 大小</div><div class="line">    """</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, eta, vector_n)</span>:</span></div><div class="line">        self.eta = eta</div><div class="line">        self.w = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(vector_n)]</div><div class="line">        self.b = <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="string">"""</span></div><div class="line">        calc是</div><div class="line">    """</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">calc</span><span class="params">(self, x)</span>:</span></div><div class="line">        <span class="keyword">return</span> np.sum(self.w * x) + self.b</div><div class="line"></div><div class="line">    <span class="string">"""</span></div><div class="line">        更新一次step</div><div class="line">    """</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">step</span><span class="params">(self, x, y)</span>:</span></div><div class="line">        self.w = self.w + self.eta * y * x</div><div class="line">        self.b = self.b + self.eta * y</div><div class="line"></div><div class="line">    <span class="string">"""</span></div><div class="line">        使用的是w = []</div><div class="line">        w * x + b = y</div><div class="line">        更新公式是：</div><div class="line">            如果y(wx+b) &lt;= 0，则更新结果</div><div class="line">                w &lt;= w + \eta \times y x</div><div class="line">                b &lt;= b + \eta \times y</div><div class="line">    """</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">train</span><span class="params">(self, x, y)</span>:</span></div><div class="line">        n_item = x.shape[<span class="number">0</span>]</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n_item):</div><div class="line">            tmp = self.calc(x[i])</div><div class="line">            <span class="keyword">if</span> y[i] * self.calc(x[i]) &lt;= <span class="number">0</span>:</div><div class="line">                self.step(x[i], y[i])</div><div class="line"></div><div class="line">    <span class="string">"""</span></div><div class="line">        返回训练出来的测试结果</div><div class="line">    """</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(self, x)</span>:</span></div><div class="line">        yy = []</div><div class="line">        print(<span class="string">"ans: w = "</span>, self.w, <span class="string">" b = "</span>, self.b)</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> x:</div><div class="line">            tmp = self.calc(i)</div><div class="line">            yy.append(tmp)</div><div class="line"></div><div class="line">        yy = np.sign(yy)</div><div class="line">        yy = yy.astype(int)</div><div class="line">        <span class="keyword">return</span> yy</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    train_data, test_data = iris.get_train_and_test(TTR)</div><div class="line"></div><div class="line">    mp = &#123;&#125;</div><div class="line">    mp[<span class="string">"Iris-setosa"</span>] = <span class="number">-1</span></div><div class="line">    mp[<span class="string">"Iris-virginica"</span>] = <span class="number">1</span></div><div class="line"></div><div class="line">    train_data_x = []</div><div class="line">    train_data_y = []</div><div class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> train_data:</div><div class="line">        train_data_x.append(item[<span class="number">0</span>:<span class="number">4</span>])</div><div class="line">        train_data_y.append(mp[item[<span class="number">4</span>:<span class="number">5</span>][<span class="number">0</span>]])</div><div class="line">    train_data_x = np.array(train_data_x)</div><div class="line">    train_data_y = np.array(train_data_y)</div><div class="line"></div><div class="line">    test_data_x = []</div><div class="line">    test_data_y = []</div><div class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> test_data:</div><div class="line">        test_data_x.append(item[<span class="number">0</span>:<span class="number">4</span>])</div><div class="line">        test_data_y.append(mp[item[<span class="number">4</span>:<span class="number">5</span>][<span class="number">0</span>]])</div><div class="line">    test_data_x = np.array(test_data_x)</div><div class="line">    test_data_y = np.array(test_data_y)</div><div class="line"></div><div class="line">    perception = Perception(<span class="number">0.9</span>, <span class="number">4</span>)</div><div class="line">    perception.train(train_data_x, train_data_y)</div><div class="line"></div><div class="line">    predict_y = perception.test(test_data_x)</div><div class="line"></div><div class="line"></div><div class="line">    print(predict_y, <span class="string">"\n\n"</span>, test_data_y)</div><div class="line">    print(np.sum(predict_y - test_data_y))</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GeekOrangeLuyao.github.io/src/uncategorized/TS-TSP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="OrangeLuYao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="OrangeLuyao的小站">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/src/uncategorized/TS-TSP/" itemprop="url">TS_TSP</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-10T02:42:47+08:00">
                2018-05-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="禁忌表算法实验————解决TSP问题"><a href="#禁忌表算法实验————解决TSP问题" class="headerlink" title="禁忌表算法实验————解决TSP问题"></a>禁忌表算法实验————解决TSP问题</h2><blockquote>
<p>本报告使用禁忌表搜素算法解决TSP问题</p>
</blockquote>
<h3 id="1-实验背景"><a href="#1-实验背景" class="headerlink" title="1. 实验背景"></a>1. 实验背景</h3><p>旅行商问题，即TSP问题（Traveling Salesman Problem），也叫旅行推销员问题、货郎担问题，是数学领域中著名问题之一。假设有一个旅行商人要拜访n个城市，他必须选择所要走的路径，路径的限制是每个城市只能拜访一次，而且最后要回到原来出发的城市。路径的选择目标是要求得的路径路程为所有路径之中的最小值。</p>
<p>旅行推销员问题是图论中最著名的问题之一，即“已给一个n个点的完全图，每条边都有一个长度，求总长度最短的经过每个顶点正好一次的封闭回路”。Edmonds，Cook和Karp等人发现，这批难题有一个值得注意的性质，对其中一个问题存在有效算法时，每个问题都会有有效算法。</p>
<p>迄今为止，这类问题中没有一个找到有效算法。倾向于接受NP完全问题（NP-Complete或NPC）和NP难题（NP-Hard或NPH）不存在有效算法这一猜想，认为这类问题的大型实例不能用精确算法求解，必须寻求这类问题的有效的近似算法。</p>
<h3 id="2-禁忌表搜索算法"><a href="#2-禁忌表搜索算法" class="headerlink" title="2. 禁忌表搜索算法"></a>2. 禁忌表搜索算法</h3><h4 id="2-1-算法简介"><a href="#2-1-算法简介" class="headerlink" title="2.1 算法简介"></a>2.1 算法简介</h4><p>禁忌（Tabu Search）算法是一种元启发式(meta-heuristic)随机搜索算法，它从一个初始可行解出发，选择一系列的特定搜索方向（移动）作为试探，选择实现让特定的目标函数值变化最多的移动。为了避免陷入局部最优解，TS搜索中采用了一种灵活的“记忆”技术，对已经进行的优化过程进行记录和选择，指导下一步的搜索方向，这就是Tabu表的建立。</p>
<h4 id="2-2-算法结合TSP"><a href="#2-2-算法结合TSP" class="headerlink" title="2.2 算法结合TSP"></a>2.2 算法结合TSP</h4><ol>
<li>在搜索中，构造一个短期循环记忆表-禁忌表，禁忌表中存放刚刚进行过的 |T|（T称为禁忌表）个邻居的移动，这种移动即解的简单变化。</li>
<li>禁忌表中的移动称为禁忌移动。对于进入禁忌表中的移动， 在以后的 |T| 次循环内是禁止的，以避免回到原来的解，从而避免陷入循环。|T| 次循环后禁忌解除。</li>
<li>禁忌表是一个循环表，在搜索过程中被循环的修改，使禁忌表始终保持 |T| 个移动。</li>
<li>即使引入了禁忌表，禁忌搜索仍可能出现循环。因此，必须给定停止准则以避免出现循环。当迭代内所发现的最好解无法改进或无法离开它时，算法停止。</li>
</ol>
<h3 id="3-算法设计流程"><a href="#3-算法设计流程" class="headerlink" title="3. 算法设计流程"></a>3. 算法设计流程</h3><h4 id="3-1-算法流程图"><a href="#3-1-算法流程图" class="headerlink" title="3.1 算法流程图"></a>3.1 算法流程图</h4><h4 id="3-2-算法实现过程"><a href="#3-2-算法实现过程" class="headerlink" title="3.2 算法实现过程"></a>3.2 算法实现过程</h4><p>使用python3作为设计语言，其中本次使用的版本是python3.6，其中使用了常规的的库有：</p>
<ol>
<li>time</li>
<li>copy</li>
<li>random</li>
<li>math</li>
</ol>
<p>使用的非内置库有：</p>
<ol>
<li>numpy</li>
<li>matplotlib</li>
</ol>
<h4 id="3-3-算法设计细节"><a href="#3-3-算法设计细节" class="headerlink" title="3.3 算法设计细节"></a>3.3 算法设计细节</h4><h5 id="3-3-1-TSP图类"><a href="#3-3-1-TSP图类" class="headerlink" title="3.3.1 TSP图类"></a>3.3.1 TSP图类</h5><ol>
<li><p>首先定义点类</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 点类</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,x,y)</span>:</span></div><div class="line">        self.x = x</div><div class="line">        self.y = y</div></pre></td></tr></table></figure>
</li>
<li><p>随后定义TSP图类，注意<code>ask_distance_for_plan()</code>的结果</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Graph</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,n)</span>:</span></div><div class="line">        self.points = []</div><div class="line">        self.point_n = n</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_point</span><span class="params">(self,p)</span>:</span></div><div class="line">        self.points.append(p)</div><div class="line">        self.point_n += <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ask_distance</span><span class="params">(self,i,j)</span>:</span></div><div class="line">        point_x = self.points[i]</div><div class="line">        point_y = self.points[j]</div><div class="line">        <span class="keyword">return</span> math.sqrt(sqr(point_x.x - point_y.x) + sqr(point_x.y - point_y.y))</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ask_distance_for_plan</span><span class="params">(self,plan)</span>:</span></div><div class="line">        res = <span class="number">0.0</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,self.point_n):</div><div class="line">            res += self.ask_distance(plan[i],plan[i<span class="number">-1</span>])</div><div class="line">        res += self.ask_distance(plan[<span class="number">0</span>],plan[self.point_n<span class="number">-1</span>])</div><div class="line">        <span class="comment"># print(plan,' ',res)</span></div><div class="line">        <span class="keyword">return</span> res</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> self.points:</div><div class="line">            print(item.x,<span class="string">" "</span>,item.y)</div></pre></td></tr></table></figure>
</li>
<li><p>禁忌表的设计<br>禁忌表可以使用一个队列，由于Python 语言原生队列比较难以使用，所以自己写了一个类似队列的操作，也就是更新一个新的tabu_table项这个操作：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">tuba_step</span><span class="params">(self,new_plan)</span>:</span></div><div class="line">    <span class="keyword">if</span> new_plan <span class="keyword">in</span> self.tuba_table:</div><div class="line">        <span class="keyword">return</span></div><div class="line">    <span class="keyword">elif</span> len(self.tuba_table) &lt; self.MAX_SIZE:</div><div class="line">        self.tuba_table.append(new_plan)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="comment"># 向前推一格</span></div><div class="line">        sz = len(self.tuba_table)</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,sz):</div><div class="line">            self.tuba_table[i<span class="number">-1</span>] = self.tuba_table[i]</div><div class="line">        self.tuba_table[sz - <span class="number">1</span>] = new_plan</div></pre></td></tr></table></figure>
</li>
<li><p>核心部分的设计<br>选取适应值作为渴望值，所以禁忌的算法就是：</p>
<blockquote>
<ul>
<li>如果比最优解更优，则更新最优解，并且作为下一个解</li>
<li>否则不断查看下面的解，是否在禁忌表中，直到找到一个不在禁忌表中的更新下一个解</li>
<li>如果没有可以更新，则解禁第一个</li>
</ul>
</blockquote>
</li>
</ol>
<p>所以核心的部分就是：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self, n, graph)</span>:</span></div><div class="line">    init_plan = self.initPlan(n)</div><div class="line">    better_plan = &#123;</div><div class="line">        <span class="string">"fitness"</span>: graph.ask_distance_for_plan(init_plan),</div><div class="line">        <span class="string">"plan"</span>: init_plan</div><div class="line">    &#125;</div><div class="line">    i_time = <span class="number">0</span></div><div class="line">    <span class="keyword">while</span> i_time &lt; self.MAX_TIME:</div><div class="line">        new_plans = self.get_new_plans(init_plan, <span class="number">50</span>)</div><div class="line">        new_res = []</div><div class="line">        <span class="keyword">for</span> plan <span class="keyword">in</span> new_plans:</div><div class="line">            _fitness = graph.ask_distance_for_plan(plan)</div><div class="line">            new_res.append(&#123;</div><div class="line">                <span class="string">"fitness"</span>: _fitness,</div><div class="line">                <span class="string">"plan"</span>: plan</div><div class="line">            &#125;)</div><div class="line">        new_res.sort(key=cmp)</div><div class="line">        <span class="comment"># print(new_res)</span></div><div class="line">        <span class="comment"># print(new_res,"\n")</span></div><div class="line">        cnt = <span class="number">0</span></div><div class="line">        flag = <span class="keyword">False</span></div><div class="line">        <span class="keyword">while</span> cnt &lt; len(new_plans):</div><div class="line">            <span class="keyword">if</span> new_res[cnt][<span class="string">"fitness"</span>] &lt; better_plan[<span class="string">"fitness"</span>]:</div><div class="line">                better_plan[<span class="string">"fitness"</span>] = new_res[cnt][<span class="string">"fitness"</span>]</div><div class="line">                better_plan[<span class="string">"plan"</span>] = copy.copy(new_res[cnt][<span class="string">"plan"</span>])</div><div class="line"></div><div class="line">                self.tuba_step(new_res[cnt][<span class="string">"plan"</span>])</div><div class="line">                flag = <span class="keyword">True</span></div><div class="line">                init_plan = copy.copy(new_res[cnt][<span class="string">"plan"</span>])</div><div class="line">                <span class="keyword">break</span></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                <span class="keyword">if</span> new_res[cnt][<span class="string">"plan"</span>] <span class="keyword">in</span> self.tuba_table:</div><div class="line">                    cnt += <span class="number">1</span></div><div class="line">                    <span class="keyword">continue</span></div><div class="line">                <span class="keyword">else</span>:</div><div class="line">                    flag = <span class="keyword">True</span></div><div class="line">                    init_plan = copy.copy(new_res[cnt][<span class="string">"plan"</span>])</div><div class="line">                    <span class="keyword">break</span></div><div class="line"></div><div class="line">        <span class="comment"># 如果都在禁忌表中，则解禁第一个</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> flag:</div><div class="line">            <span class="keyword">if</span> new_res[<span class="number">0</span>][<span class="string">"plan"</span>] <span class="keyword">in</span> self.tuba_table:</div><div class="line">                self.tuba_table.remove(new_res[<span class="number">0</span>][<span class="string">"plan"</span>])</div><div class="line">            init_plan = copy.copy(new_res[<span class="number">0</span>][<span class="string">"plan"</span>])</div><div class="line"></div><div class="line">        print(better_plan)</div><div class="line"></div><div class="line">        i_time += <span class="number">1</span></div><div class="line">    print(better_plan)</div><div class="line">    <span class="keyword">return</span> better_plan</div></pre></td></tr></table></figure></p>
<ol>
<li>其他的细节<br>生成初始解<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 初始化一个序列作为初始数据</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">initPlan</span><span class="params">(self, n)</span>:</span></div><div class="line">    random.seed(time.time())</div><div class="line">    init_plan = []</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n):</div><div class="line">        init_plan.append(i)</div><div class="line"></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</div><div class="line">        j = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</div><div class="line">        <span class="keyword">while</span> i == j:</div><div class="line">            j = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</div><div class="line">        init_plan[i], init_plan[j] = init_plan[j], init_plan[i]</div><div class="line"></div><div class="line">    <span class="comment"># print(init_plan)</span></div><div class="line">    <span class="keyword">return</span> init_plan</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">tuba_step</span><span class="params">(self, new_plan)</span>:</span></div><div class="line">    <span class="keyword">if</span> new_plan <span class="keyword">in</span> self.tuba_table:</div><div class="line">        <span class="keyword">return</span></div><div class="line">    <span class="keyword">elif</span> len(self.tuba_table) &lt; self.MAX_SIZE:</div><div class="line">        self.tuba_table.append(new_plan)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        sz = len(self.tuba_table)</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, sz):</div><div class="line">            self.tuba_table[i - <span class="number">1</span>] = self.tuba_table[i]</div><div class="line">        self.tuba_table[sz - <span class="number">1</span>] = new_plan</div><div class="line"></div><div class="line">        <span class="comment"># 从已有的一个队列中得到一个新的</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_new_plan</span><span class="params">(self, now_plan)</span>:</span></div><div class="line">    random.seed(time.time())</div><div class="line">    n = len(now_plan)</div><div class="line"></div><div class="line">    i = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</div><div class="line">    j = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</div><div class="line">    <span class="keyword">while</span> i == j:</div><div class="line">        j = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</div><div class="line"></div><div class="line">    new_plan = copy.copy(now_plan)</div><div class="line">    <span class="comment"># print("new_plan = ",new_plan)</span></div><div class="line">    <span class="comment"># print(i,' ',j)</span></div><div class="line">    new_plan[i], new_plan[j] = new_plan[j], new_plan[i]</div><div class="line">    <span class="keyword">return</span> new_plan</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_new_plans</span><span class="params">(self, now_plan, new_cnt)</span>:</span></div><div class="line">    new_plans = []</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(new_cnt):</div><div class="line">        new_plan = self.get_new_plan(now_plan)</div><div class="line">        <span class="keyword">while</span> (new_plan <span class="keyword">in</span> new_plans) <span class="keyword">or</span> (new_plan <span class="keyword">in</span> self.tuba_table):</div><div class="line">            new_plan = self.get_new_plan(now_plan)</div><div class="line">        new_plans.append(new_plan)</div><div class="line">    <span class="keyword">return</span> new_plans</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="4-实验结果"><a href="#4-实验结果" class="headerlink" title="4. 实验结果"></a>4. 实验结果</h3><h4 id="4-1-实验数据"><a href="#4-1-实验数据" class="headerlink" title="4.1 实验数据"></a>4.1 实验数据</h4><p>使用的实验数据如下：<br>给出所有点的坐标<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">A 2.5 4.0</div><div class="line">B 1.2 -2.4</div><div class="line">C 8.7 1.2</div><div class="line">D 3.6 12.1</div><div class="line">E -5.5 0.94</div><div class="line">F -6.6 -12.6</div><div class="line">G 0.18 5.219</div><div class="line">H 12.5 14.3609</div><div class="line">I 22.5 -5.26</div><div class="line">J 1.61 4.5</div><div class="line">K 2.1 -5.6</div><div class="line">L 0 25</div><div class="line">M 9.2 -32</div><div class="line">N -1 7</div><div class="line">O -5 -8</div><div class="line">P 21 35</div><div class="line">Q 16 7.5</div><div class="line">R -21 5</div><div class="line">S -7 -25.5</div><div class="line">T 12 17.5</div></pre></td></tr></table></figure></p>
<p>给出读入数据的python代码：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">graph = Graph(<span class="number">0</span>)</div><div class="line"><span class="keyword">with</span> open(<span class="string">"in.txt"</span>,<span class="string">"r"</span>) <span class="keyword">as</span> f:</div><div class="line">    lines = f.readlines()</div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</div><div class="line">        line = str(line)</div><div class="line">        <span class="comment"># print(line)</span></div><div class="line">        items = line.split(<span class="string">' '</span>)</div><div class="line">        x = float(items[<span class="number">1</span>])</div><div class="line">        y = float(items[<span class="number">2</span>])</div><div class="line">        <span class="comment"># print('x =',x,' y = ',y)</span></div><div class="line">        graph.add_point(Point(x,y))</div></pre></td></tr></table></figure></p>
<h4 id="4-2-实验结果展示"><a href="#4-2-实验结果展示" class="headerlink" title="4.2 实验结果展示"></a>4.2 实验结果展示</h4><p>在循环次数在1000，禁忌表的长度为100，每次生成50个解的时候的解:<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;<span class="string">'fitness'</span>: <span class="number">229.29301386606764</span>, <span class="string">'plan'</span>: [<span class="number">15</span>, <span class="number">19</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">4</span>, <span class="number">17</span>, <span class="number">11</span>]&#125;</div></pre></td></tr></table></figure></p>
<h4 id="4-2-实验结果分析"><a href="#4-2-实验结果分析" class="headerlink" title="4.2 实验结果分析"></a>4.2 实验结果分析</h4><ol>
<li><p>修改迭代次数的结果<br>查看每次迭代的结果<br>可以看到TS搜索是可以非常快速的收敛到最后的结果</p>
</li>
<li><p>修改禁忌表的大小<br>对于不同的禁忌表大小<br>注意到左边的标签，其实结果还是不错的</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="number">236.10576449755874</span></div><div class="line"><span class="number">234.09108995597467</span></div><div class="line"><span class="number">246.86027733574613</span></div><div class="line"><span class="number">225.2933368344327</span></div><div class="line"><span class="number">262.9605263450174</span></div><div class="line"><span class="number">246.28820695769377</span></div><div class="line"><span class="number">234.71343544402984</span></div><div class="line"><span class="number">227.26144867324177</span></div><div class="line"><span class="number">229.7833515012846</span></div><div class="line"><span class="number">242.25058271866212</span></div><div class="line"><span class="number">229.1927461840333</span></div><div class="line"><span class="number">224.54844132640252</span></div><div class="line"><span class="number">237.3646981725542</span></div><div class="line"><span class="number">249.88559805941748</span></div><div class="line"><span class="number">237.02818502264515</span></div><div class="line"><span class="number">240.0783888051765</span></div><div class="line"><span class="number">221.98286157579287</span></div><div class="line"><span class="number">248.5770670755478</span></div><div class="line"><span class="number">256.32503827973477</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p>可以看到，其实<code>tabu_size</code>在这个状况下的结果其实还是比较稳定的。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GeekOrangeLuyao.github.io/src/uncategorized/SA-TSP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="OrangeLuYao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="OrangeLuyao的小站">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/src/uncategorized/SA-TSP/" itemprop="url">SA_TSP</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-10T02:42:01+08:00">
                2018-05-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="模拟退火算法实验————解决TSP问题"><a href="#模拟退火算法实验————解决TSP问题" class="headerlink" title="模拟退火算法实验————解决TSP问题"></a>模拟退火算法实验————解决TSP问题</h2><blockquote>
<p>本报告使用模拟退火算法解决TSP问题</p>
</blockquote>
<h3 id="1-实验背景"><a href="#1-实验背景" class="headerlink" title="1. 实验背景"></a>1. 实验背景</h3><p>旅行商问题，即TSP问题（Traveling Salesman Problem），也叫旅行推销员问题、货郎担问题，是数学领域中著名问题之一。假设有一个旅行商人要拜访n个城市，他必须选择所要走的路径，路径的限制是每个城市只能拜访一次，而且最后要回到原来出发的城市。路径的选择目标是要求得的路径路程为所有路径之中的最小值。</p>
<p>旅行推销员问题是图论中最著名的问题之一，即“已给一个n个点的完全图，每条边都有一个长度，求总长度最短的经过每个顶点正好一次的封闭回路”。Edmonds，Cook和Karp等人发现，这批难题有一个值得注意的性质，对其中一个问题存在有效算法时，每个问题都会有有效算法。</p>
<p>迄今为止，这类问题中没有一个找到有效算法。倾向于接受NP完全问题（NP-Complete或NPC）和NP难题（NP-Hard或NPH）不存在有效算法这一猜想，认为这类问题的大型实例不能用精确算法求解，必须寻求这类问题的有效的近似算法。</p>
<h3 id="2-模拟退火算法"><a href="#2-模拟退火算法" class="headerlink" title="2. 模拟退火算法"></a>2. 模拟退火算法</h3><h4 id="2-1-算法简介"><a href="#2-1-算法简介" class="headerlink" title="2.1 算法简介"></a>2.1 算法简介</h4><p>模拟退火算法（Simulate Anneal，SA）是一种通用概率演算法，用来在一个大的搜寻空间内找寻命题的最优解。</p>
<p>模拟退火的出发点是基于物理中固体物质的退火过程与一般组合优化问题之间的相似性。模拟退火算法是一种通用的优化算法，其物理退火过程由加温过程、等温过程、冷却过程这三部分组成。</p>
<p>模拟退火的原理也和金属退火的原理近似：将热力学的理论套用到统计学上，将搜寻空间内每一点想像成空气内的分子；分子的能量，就是它本身的动能；而搜寻空间内的每一点，也像空气分子一样带有“能量”，以表示该点对命题的合适程度。演算法先以搜寻空间内一个任意点作起始：每一步先选择一个“邻居”，然后再计算从现有位置到达“邻居”的概率。</p>
<h4 id="2-2-算法结合TSP"><a href="#2-2-算法结合TSP" class="headerlink" title="2.2 算法结合TSP"></a>2.2 算法结合TSP</h4><p>状态空间与状态产生函数</p>
<ol>
<li>搜索空间也称为状态空间，它由经过编码的可行解的集合组成。</li>
<li>状态产生函数应尽可能保证产生的候选解遍布全部解空间。通常由两部分组成，即产生候选解的方式和候选解产生的概率分布。</li>
<li>候选解一般采用按照某一概率密度函数对解空间进行随机采样来获得。</li>
<li>概率分布可以是均匀分布、正态分布、指数分布等。</li>
</ol>
<p>状态转移概率</p>
<ol>
<li>状态转移概率是指从一个状态向另一个状态的转移概率。</li>
<li>通俗的理解是接受一个新解为当前解的概率。</li>
<li>它与当前的温度参数T有关，随温度下降而减小。</li>
<li>一般采用Metropolis准则。</li>
</ol>
<p>内循环终止准则<br>也称Metropolis抽样稳定准则，用于决定在各温度下产生候选解的数目。常用的抽样稳定准则包括：</p>
<ol>
<li>检验目标函数的均值是否稳定。</li>
<li>连续若干步的目标值变化较小。</li>
<li>按一定的步数抽样。</li>
</ol>
<p>外循环终止准则<br>即算法终止准则，常用的包括：</p>
<ol>
<li>设置终止温度的阈值。</li>
<li>设置外循环迭代次数。</li>
<li>算法搜索到的最优值连续若干步保持不变。</li>
<li>检验系统熵是否稳定。</li>
</ol>
<h3 id="3-算法设计流程"><a href="#3-算法设计流程" class="headerlink" title="3. 算法设计流程"></a>3. 算法设计流程</h3><h4 id="3-1-算法流程图"><a href="#3-1-算法流程图" class="headerlink" title="3.1 算法流程图"></a>3.1 算法流程图</h4><h4 id="3-2-算法实现过程"><a href="#3-2-算法实现过程" class="headerlink" title="3.2 算法实现过程"></a>3.2 算法实现过程</h4><p>使用python3作为设计语言，其中本次使用的版本是python3.6，其中使用了常规的的库有：</p>
<ol>
<li>time</li>
<li>copy</li>
<li>random</li>
<li>math</li>
</ol>
<p>使用的非内置库有：</p>
<ol>
<li>numpy</li>
<li>matplotlib</li>
</ol>
<h5 id="3-2-1-算法公式"><a href="#3-2-1-算法公式" class="headerlink" title="3.2.1 算法公式"></a>3.2.1 算法公式</h5><blockquote>
<p>本算法设计的公式有：</p>
<ol>
<li>Metropolis准则</li>
<li>降温方法</li>
</ol>
</blockquote>
<h6 id="3-2-1-1-Metropolis准则"><a href="#3-2-1-1-Metropolis准则" class="headerlink" title="3.2.1.1 Metropolis准则"></a>3.2.1.1 Metropolis准则</h6><p>首先计算两次适应值的差距<br>$$\Delta f = f_1 - f_2$$<br>随后计算：<br>$$e^{-\frac{\Delta f}{T_k}} &gt; \xi$$<br>其中$\xi \in (0,1)$是一个随机的小数<br>根据上面这个式子判断是否接受一个新的值</p>
<h6 id="3-2-1-2-降温方法"><a href="#3-2-1-2-降温方法" class="headerlink" title="3.2.1.2 降温方法"></a>3.2.1.2 降温方法</h6><p>我这里使用的是用指数更新的方式进行温度更新<br>$$T = T \times q$$</p>
<h5 id="3-2-2-算法设计"><a href="#3-2-2-算法设计" class="headerlink" title="3.2.2 算法设计"></a>3.2.2 算法设计</h5><h6 id="3-2-2-1-TSP的基础类"><a href="#3-2-2-1-TSP的基础类" class="headerlink" title="3.2.2.1 TSP的基础类"></a>3.2.2.1 TSP的基础类</h6><p>首先对于TSP问题，首先需要解决对于TSP至少图的问题的解决</p>
<ol>
<li><p>点类</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,x,y)</span>:</span></div><div class="line">        self.x = x</div><div class="line">        self.y = y</div></pre></td></tr></table></figure>
</li>
<li><p>图类<br>对于TSP最重要的是通过一个行走序列，得到路径长度，所以其中的<code>ask_distance_for_plan()</code>是非常重要的。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Graph</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,n)</span>:</span></div><div class="line">        self.points = []</div><div class="line">        self.point_n = n</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_point</span><span class="params">(self,p)</span>:</span></div><div class="line">        self.points.append(p)</div><div class="line">        self.point_n += <span class="number">1</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ask_distance</span><span class="params">(self,i,j)</span>:</span></div><div class="line">        point_x = self.points[i]</div><div class="line">        point_y = self.points[j]</div><div class="line">        <span class="keyword">return</span> math.sqrt(sqr(point_x.x - point_y.x) + sqr(point_x.y - point_y.y))</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ask_distance_for_plan</span><span class="params">(self,plan)</span>:</span></div><div class="line">        res = <span class="number">0.0</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,self.point_n):</div><div class="line">            res += self.ask_distance(plan[i],plan[i<span class="number">-1</span>])</div><div class="line">        res += self.ask_distance(plan[<span class="number">0</span>],plan[self.point_n<span class="number">-1</span>])</div><div class="line">        <span class="comment"># print(plan,' ',res)</span></div><div class="line">        <span class="keyword">return</span> res</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> self.points:</div><div class="line">            print(item.x,<span class="string">" "</span>,item.y)</div></pre></td></tr></table></figure>
</li>
</ol>
<h6 id="3-2-2-2-初始化"><a href="#3-2-2-2-初始化" class="headerlink" title="3.2.2.2 初始化"></a>3.2.2.2 初始化</h6><p>对于模拟退火的时候，初始化操作就是规定初始温度，结束温度，每个温度中的迭代次数，温度削减率$q$<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,t_max,t_min,L,q)</span>:</span></div><div class="line">    self.T_MAX = t_max</div><div class="line">    self.T_MIN = t_min</div><div class="line">    self.L = L</div><div class="line">    self.q = q</div></pre></td></tr></table></figure></p>
<h6 id="3-2-2-3-run-最主要的函数"><a href="#3-2-2-3-run-最主要的函数" class="headerlink" title="3.2.2.3 run()最主要的函数"></a>3.2.2.3 <code>run()</code>最主要的函数</h6><p>给出核心的代码：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self,n,graph)</span>:</span></div><div class="line">    <span class="comment"># 随机化种子</span></div><div class="line">    random.seed(time.time())</div><div class="line"></div><div class="line">    <span class="comment"># 初始化需要的变量    </span></div><div class="line">    init_plan = self.initPlan(n)</div><div class="line">    T = self.T_MAX</div><div class="line">    </div><div class="line">    res = &#123;</div><div class="line">            <span class="string">"fitness"</span>: graph.ask_distance_for_plan(init_plan),</div><div class="line">            <span class="string">"plan"</span>: init_plan</div><div class="line">            &#125;</div><div class="line">    </div><div class="line">    count = <span class="number">0</span></div><div class="line">    T_s = []</div><div class="line">    best_ans = []</div><div class="line">    </div><div class="line">    <span class="comment"># 温度处理</span></div><div class="line">    <span class="keyword">while</span> T &gt; self.T_MIN:</div><div class="line"></div><div class="line">        <span class="comment"># 迭代过程</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.L):</div><div class="line">            <span class="comment"># 寻找新的解</span></div><div class="line">            new_plan = copy.copy(init_plan)</div><div class="line">            new_plan = self.get_new_plan(new_plan)</div><div class="line">            count += <span class="number">1</span></div><div class="line">            </div><div class="line">            init_fitness = graph.ask_distance_for_plan(init_plan)</div><div class="line">            new_fitness  = graph.ask_distance_for_plan(new_plan)</div><div class="line">        </div><div class="line">            <span class="keyword">if</span> res[<span class="string">"fitness"</span>] &gt; init_fitness:</div><div class="line">                res[<span class="string">"fitness"</span>] = init_fitness</div><div class="line">                res[<span class="string">"plan"</span>] = copy.copy(init_plan)</div><div class="line">            <span class="keyword">if</span> res[<span class="string">"fitness"</span>] &gt; new_fitness:</div><div class="line">                res[<span class="string">"fitness"</span>] = new_fitness</div><div class="line">                res[<span class="string">"plan"</span>] = copy.copy(new_plan)</div><div class="line">            </div><div class="line">            <span class="comment"># print("fitness = ",init_fitness," plan :\n",init_plan)                </span></div><div class="line">            <span class="comment"># 利用差值，以及之前的结果判断结果是否满足接受</span></div><div class="line">            delta_fitness = new_fitness - init_fitness</div><div class="line">            <span class="comment"># print("delta = ",delta_fitness)</span></div><div class="line"></div><div class="line">            <span class="comment"># if the fitness get smaller , then it should be good</span></div><div class="line">            <span class="comment"># if the fitness get bigger , the it can be accepted by rate</span></div><div class="line">            <span class="keyword">if</span> delta_fitness &gt;= <span class="number">0</span>:</div><div class="line">                div = random.random()</div><div class="line">                metropolis = math.exp(-delta_fitness / T)</div><div class="line">                </div><div class="line">                <span class="keyword">if</span> metropolis &lt;= div:</div><div class="line">                    init_plan = copy.copy(new_plan)</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                init_plan = copy.copy(new_plan)</div><div class="line"></div><div class="line">        T_s.append(T)</div><div class="line">        best_ans.append(res[<span class="string">"fitness"</span>])</div><div class="line">        T *= self.q</div><div class="line">        </div><div class="line">    print(res)</div><div class="line">    <span class="keyword">return</span> res,T_s,best_ans</div></pre></td></tr></table></figure></p>
<h3 id="4-实验结果"><a href="#4-实验结果" class="headerlink" title="4. 实验结果"></a>4. 实验结果</h3><h4 id="4-1-实验数据"><a href="#4-1-实验数据" class="headerlink" title="4.1 实验数据"></a>4.1 实验数据</h4><p>使用的实验数据如下：<br>给出所有点的坐标<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">A 2.5 4.0</div><div class="line">B 1.2 -2.4</div><div class="line">C 8.7 1.2</div><div class="line">D 3.6 12.1</div><div class="line">E -5.5 0.94</div><div class="line">F -6.6 -12.6</div><div class="line">G 0.18 5.219</div><div class="line">H 12.5 14.3609</div><div class="line">I 22.5 -5.26</div><div class="line">J 1.61 4.5</div><div class="line">K 2.1 -5.6</div><div class="line">L 0 25</div><div class="line">M 9.2 -32</div><div class="line">N -1 7</div><div class="line">O -5 -8</div><div class="line">P 21 35</div><div class="line">Q 16 7.5</div><div class="line">R -21 5</div><div class="line">S -7 -25.5</div><div class="line">T 12 17.5</div></pre></td></tr></table></figure></p>
<p>给出读入数据的python代码：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">graph = Graph(<span class="number">0</span>)</div><div class="line"><span class="keyword">with</span> open(<span class="string">"in.txt"</span>,<span class="string">"r"</span>) <span class="keyword">as</span> f:</div><div class="line">    lines = f.readlines()</div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</div><div class="line">        line = str(line)</div><div class="line">        <span class="comment"># print(line)</span></div><div class="line">        items = line.split(<span class="string">' '</span>)</div><div class="line">        x = float(items[<span class="number">1</span>])</div><div class="line">        y = float(items[<span class="number">2</span>])</div><div class="line">        <span class="comment"># print('x =',x,' y = ',y)</span></div><div class="line">        graph.add_point(Point(x,y))</div></pre></td></tr></table></figure></p>
<h4 id="4-2-实验结果展示"><a href="#4-2-实验结果展示" class="headerlink" title="4.2 实验结果展示"></a>4.2 实验结果展示</h4><p>使用已有代码进行运行，运行结果如下：<br>最终的结果：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&#123;<span class="string">'fitness'</span>: <span class="number">224.65153949772267</span>, </div><div class="line"><span class="string">'plan'</span>: [<span class="number">7</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">17</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">19</span>]&#125;</div></pre></td></tr></table></figure></p>
<h4 id="4-2-实验结果分析"><a href="#4-2-实验结果分析" class="headerlink" title="4.2 实验结果分析"></a>4.2 实验结果分析</h4><ol>
<li>退火过程和最优解<br>在中间算法过程中，记录最优结果，查看最优结果和退火中温度的变化<br>结果如图所示：</li>
<li><p>改变迭代次数$L$和最终结果<br>改变每个温度的迭代次数，查看最终的结果。<br>中间折线的结果，是取得这些结果：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">L = [<span class="number">10</span>,<span class="number">30</span>,<span class="number">50</span>,<span class="number">80</span>,<span class="number">100</span>,<span class="number">120</span>,<span class="number">150</span>,<span class="number">180</span>,<span class="number">200</span>,<span class="number">300</span>,<span class="number">500</span>]</div></pre></td></tr></table></figure>
</li>
<li><p>改变温度改变率$q$<br>改变温度的修改，修改$q$的值<br>中间折现的结果，是取得如下的改变率：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">q_s = [<span class="number">0.75</span>,<span class="number">0.76</span>,<span class="number">0.77</span>,<span class="number">0.78</span>,<span class="number">0.79</span>,<span class="number">0.8</span>,<span class="number">0.81</span>,<span class="number">0.82</span>,<span class="number">0.83</span>,<span class="number">0.84</span>,</div><div class="line"><span class="number">0.85</span>,<span class="number">0.86</span>,<span class="number">0.87</span>,<span class="number">0.88</span>,<span class="number">0.89</span>,<span class="number">0.9</span>,<span class="number">0.91</span>,<span class="number">0.92</span>,<span class="number">0.93</span>,<span class="number">0.94</span>,<span class="number">0.95</span>,<span class="number">0.96</span>,<span class="number">0.97</span>,<span class="number">0.98</span>]</div></pre></td></tr></table></figure>
</li>
<li><p>总结<br>通过上述两个数据结果，我们可以明显看到，模拟退火在一定程度上可以得到非常好的解，但是在实际的运用中，却不是非常稳定的可以得到比较好的结果。随着迭代次数求解的过程，并不一定结果稳定的变好。</p>
</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GeekOrangeLuyao.github.io/src/uncategorized/PSO-TSP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="OrangeLuYao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="OrangeLuyao的小站">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/src/uncategorized/PSO-TSP/" itemprop="url">PSO_TSP</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-10T02:41:04+08:00">
                2018-05-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="粒子群算法实验————解决TSP问题"><a href="#粒子群算法实验————解决TSP问题" class="headerlink" title="粒子群算法实验————解决TSP问题"></a>粒子群算法实验————解决TSP问题</h2><blockquote>
<p>本报告使用粒子群算法解决TSP问题</p>
</blockquote>
<h3 id="1-实验背景"><a href="#1-实验背景" class="headerlink" title="1. 实验背景"></a>1. 实验背景</h3><p>旅行商问题，即TSP问题（Traveling Salesman Problem），也叫旅行推销员问题、货郎担问题，是数学领域中著名问题之一。假设有一个旅行商人要拜访n个城市，他必须选择所要走的路径，路径的限制是每个城市只能拜访一次，而且最后要回到原来出发的城市。路径的选择目标是要求得的路径路程为所有路径之中的最小值。</p>
<p>旅行推销员问题是图论中最著名的问题之一，即“已给一个n个点的完全图，每条边都有一个长度，求总长度最短的经过每个顶点正好一次的封闭回路”。Edmonds，Cook和Karp等人发现，这批难题有一个值得注意的性质，对其中一个问题存在有效算法时，每个问题都会有有效算法。</p>
<p>迄今为止，这类问题中没有一个找到有效算法。倾向于接受NP完全问题（NP-Complete或NPC）和NP难题（NP-Hard或NPH）不存在有效算法这一猜想，认为这类问题的大型实例不能用精确算法求解，必须寻求这类问题的有效的近似算法。</p>
<h3 id="2-粒子群算法"><a href="#2-粒子群算法" class="headerlink" title="2. 粒子群算法"></a>2. 粒子群算法</h3><h4 id="2-1-算法简介"><a href="#2-1-算法简介" class="headerlink" title="2.1 算法简介"></a>2.1 算法简介</h4><p>粒子群算法，也称粒子群优化算法或鸟群觅食算法（Particle Swarm Optimization），缩写为 PSO。PSO 算法属于进化算法的一种，和模拟退火算法相似，它也是从随机解出发，通过迭代寻找最优解，它也是通过适应度来评价解的品质，但它比遗传算法规则更为简单，它没有遗传算法的“交叉”(Crossover) 和“变异”(Mutation) 操作，它通过追随当前搜索到的最优值来寻找全局最优。这种算法以其实现容易、精度高、收敛快等优点引起了学术界的重视，并且在解决实际问题中展示了其优越性。粒子群算法是一种并行算法。</p>
<p>PSO模拟鸟群的捕食行为。设想这样一个场景：一群鸟在随机搜索食物。在这个区域里只有一块食物。所有的鸟都不知道食物在那里。但是他们知道当前的位置离食物还有多远。那么找到食物的最优策略是什么呢。最简单有效的就是搜寻目前离食物最近的鸟的周围区域。</p>
<p>PSO从这种模型中得到启示并用于解决优化问题。PSO中，每个优化问题的解都是搜索空间中的一只鸟。我们称之为“粒子”。所有的粒子都有一个由被优化的函数决定的适应值(fitness value)，每个粒子还有一个速度决定他们飞翔的方向和距离。然后粒子们就追随当前的最优粒子在解空间中搜索。</p>
<p>PSO 初始化为一群随机粒子(随机解)。然后通过迭代找到最优解。在每一次迭代中，粒子通过跟踪两个”极值”来更新自己。第一个就是粒子本身所找到的最优解，这个解叫做个体极值pBest。另一个极值是整个种群目前找到的最优解，这个极值是全局极值gBest。另外也可以不用整个种群而只是用其中一部分作为粒子的邻居，那么在所有邻居中的极值就是局部极值。</p>
<h4 id="2-2-算法结合TSP"><a href="#2-2-算法结合TSP" class="headerlink" title="2.2 算法结合TSP"></a>2.2 算法结合TSP</h4><p>由于TSP是离散问题,所以普通的PSO方法无法使用,必须使用广义的PSO算法.</p>
<p>广义粒子群算法模型和遗传算法相当类似，目前网上有关于粒子群算法求解TSP的很多论文或代码都是基于广义粒子群算法的，说简单点就是进化思想，用交叉变异代替了基本粒子群算法的迭代公式，当然他们也还是有粒子群优化的本质思想的，如与全局最优编码交叉，与局部最优编码交叉，变异等都是源自于基本粒子群算法的迭代公式。</p>
<p>在这样的背景下,我们设计了独特的速度更新公式,利用概率来作为参数调整的方式,使得原有的公式可以继续扩展的使用.</p>
<p>具体算法详见设计细节</p>
<h3 id="3-算法设计流程"><a href="#3-算法设计流程" class="headerlink" title="3. 算法设计流程"></a>3. 算法设计流程</h3><h4 id="3-1-算法流程图"><a href="#3-1-算法流程图" class="headerlink" title="3.1 算法流程图"></a>3.1 算法流程图</h4><p>如下图所示:</p>
<h4 id="3-2-算法实现过程"><a href="#3-2-算法实现过程" class="headerlink" title="3.2 算法实现过程"></a>3.2 算法实现过程</h4><p>使用python3作为设计语言，其中本次使用的版本是python3.6，其中使用了常规的的库有：</p>
<ol>
<li>time</li>
<li>copy</li>
<li>random</li>
<li>math</li>
</ol>
<p>使用的非内置库有：</p>
<ol>
<li>numpy</li>
<li>matplotlib</li>
</ol>
<h5 id="3-2-1-算法公式"><a href="#3-2-1-算法公式" class="headerlink" title="3.2.1 算法公式"></a>3.2.1 算法公式</h5><blockquote>
<p>PSO 算法包含的公式有：</p>
<ol>
<li>速度更新公式</li>
<li>位置更新公式<br>由于是在离散场景下的实际应用问题，所以这里还需要改变部分以适应TSP问题的要求</li>
</ol>
</blockquote>
<ol>
<li>速度更新公式<br>$$V<em>{id}^{k+1} = V</em>{id}^{k} + c<em>1 <em> \eta </em> (p</em>{id}^{k} - x_{id}^{k}) + c<em>2 <em> \xi </em> (p</em>{gd}^{k} - x_{id}^{k})$$</li>
</ol>
<ul>
<li>下标id 表示群体id</li>
<li>k 表示的是迭代次数</li>
<li>c1,c2是学习因子</li>
<li>$\eta$,$\xi \in [0,1]$</li>
<li>$p_{id}$表示本个体的历史最优</li>
<li>$p_{gd}$表示本群体的最优</li>
</ul>
<ol>
<li><p>位置更新公式<br>$$x<em>{id}^{k+1} = x</em>{id}^{k} + v_{id}^{k+1}$$<br>利用加操作，这样的操作就可以</p>
</li>
<li><p>与TSP问题协调<br>以上公式为PSO的经典计算公式，但是在结合TSP问题中，同时出现了如下问题：</p>
</li>
</ol>
<ul>
<li>编码要求中无法使用浮点数为TSP问题编码</li>
<li>TSP问题无法进行直接速度相加</li>
</ul>
<p>为了解决以上的问题，在处理过程中使用了一定的变通的手法：</p>
<blockquote>
<p>粒子群本质上是使用历史最好和群体最好的结果来不断优化群体，而其速度就是定义为更新某个群体的方式<br>在顺序编码中最好的更新方式就是对于数据位置的交换，因在，在次数的更新速度我们定义为以一定的概率接受某两个位置的交换。<br>也就是说，以概率的方式解释上述的速度更新公式和位置更新公式。</p>
</blockquote>
<p>具体的处理方式和代码参见下一节</p>
<h5 id="3-2-2-算法设计细节"><a href="#3-2-2-算法设计细节" class="headerlink" title="3.2.2 算法设计细节"></a>3.2.2 算法设计细节</h5><ol>
<li>TSP处理<br>首先需要定义图本身<br>首先定义一个点类<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x, y)</span>:</span></div><div class="line">        self.x = x</div><div class="line">        self.y = y</div></pre></td></tr></table></figure>
</li>
</ol>
<p>随后定义图类，注意到其中的<code>ask_distance_for_plan()</code>方法，这样就可以直接用这个图对于一个可能的序列获取改方案的结果.<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Graph</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, n)</span>:</span></div><div class="line">        self.points = []</div><div class="line">        self.point_n = n</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_point</span><span class="params">(self, p)</span>:</span></div><div class="line">        self.points.append(p)</div><div class="line">        self.point_n += <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ask_distance</span><span class="params">(self, i, j)</span>:</span></div><div class="line">        point_x = self.points[i]</div><div class="line">        point_y = self.points[j]</div><div class="line">        <span class="keyword">return</span> math.sqrt(sqr(point_x.x - point_y.x) + sqr(point_x.y - point_y.y))</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ask_distance_for_plan</span><span class="params">(self, plan)</span>:</span></div><div class="line">        res = <span class="number">0.0</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, self.point_n):</div><div class="line">            res += self.ask_distance(plan[i], plan[i - <span class="number">1</span>])</div><div class="line">        res += self.ask_distance(plan[<span class="number">0</span>], plan[self.point_n - <span class="number">1</span>])</div><div class="line">        <span class="comment"># print(plan,' ',res)</span></div><div class="line">        <span class="keyword">return</span> res</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> self.points:</div><div class="line">            print(item.x, <span class="string">" "</span>, item.y)</div></pre></td></tr></table></figure></p>
<ol>
<li>定义Swarm类<br>下面定义粒子群类,需要的属性是:</li>
</ol>
<ul>
<li>当前的方案</li>
<li>当前的方案结构</li>
<li>历史最优方案</li>
<li>历史最优方案的结果<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Swarm</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, plan)</span>:</span></div><div class="line">        self.plan = copy.copy(plan)</div><div class="line">        self.fitness = <span class="number">0.0</span></div><div class="line">        self.best = <span class="number">0.0</span></div><div class="line">        self.best_plan = []</div></pre></td></tr></table></figure>
</li>
</ul>
<ol>
<li>定义PSO类<br>下面定义PSO类<br>为了保证代码设计的完整性,所以这里的解释在注释中:<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">PSO</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">        构造函数,实际上设置基础参数</div><div class="line">        max_group 表示群体个数</div><div class="line">        max_time 表示最大迭代次数</div><div class="line">        c1,c2表示学习银子</div><div class="line">    """</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, max_group=<span class="number">100</span>, max_time=<span class="number">1000</span>, c1=<span class="number">1</span>, c2=<span class="number">1</span>)</span>:</span></div><div class="line">        self.MAX_TIME = max_time</div><div class="line">        self.MAX_GROUP = max_group</div><div class="line">        self.c1 = c1</div><div class="line">        self.c2 = c2</div><div class="line"></div><div class="line">    <span class="string">"""</span></div><div class="line">        给定向量的大小,返回一个不重复的随机向量</div><div class="line">    """</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">init_plan</span><span class="params">(self, n)</span>:</span></div><div class="line">        <span class="comment"># 设置随机数种子</span></div><div class="line">        random.seed(time.time())</div><div class="line">        init_plan = []</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n):</div><div class="line">            init_plan.append(i)</div><div class="line"></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</div><div class="line">            <span class="comment"># 随机两个不相同的数字</span></div><div class="line">            j = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</div><div class="line">            <span class="keyword">while</span> i == j:</div><div class="line">                j = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</div><div class="line">            init_plan[i], init_plan[j] = init_plan[j], init_plan[i]</div><div class="line"></div><div class="line">        <span class="keyword">return</span> init_plan</div><div class="line"></div><div class="line">    <span class="string">"""</span></div><div class="line">        给定群体大小,返回所获得的拥有不相同的数据的群体</div><div class="line">    """</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">init_group</span><span class="params">(self, n, graph)</span>:</span></div><div class="line">        group = []</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.MAX_GROUP):</div><div class="line">            new_plan = self.init_plan(n)</div><div class="line"></div><div class="line">            <span class="keyword">while</span> new_plan <span class="keyword">in</span> group:</div><div class="line">                new_plan = self.init_plan(n)</div><div class="line">            group.append(new_plan)</div><div class="line"></div><div class="line">        <span class="keyword">return</span> group</div><div class="line"></div><div class="line">    <span class="string">"""</span></div><div class="line">        实际的运行函数</div><div class="line">        传入的数据是:</div><div class="line">            * 群体数据</div><div class="line">            * 群体图本身</div><div class="line">    """ </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self, n, graph)</span>:</span></div><div class="line">        <span class="comment"># 设置随机数种子</span></div><div class="line">        random.seed(time.time())</div><div class="line">        group = self.init_group(n, graph)</div><div class="line"></div><div class="line">        <span class="comment"># 获取初始群体</span></div><div class="line">        swarms = []</div><div class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> group:</div><div class="line">            tmp = Swarm(item)</div><div class="line">            tmp.fitness = graph.ask_distance_for_plan(item)</div><div class="line">            tmp.best = graph.ask_distance_for_plan(item)</div><div class="line">            tmp.best_plan = copy.copy(tmp.plan)</div><div class="line">            tmp.speed = self.init_plan(n)</div><div class="line">            swarms.append(tmp)</div><div class="line"></div><div class="line">        i_time = <span class="number">0</span></div><div class="line"></div><div class="line">        <span class="comment"># 最优值记录</span></div><div class="line">        swarm_best = &#123;</div><div class="line">            <span class="string">"fitness"</span>: swarms[<span class="number">0</span>].fitness,</div><div class="line">            <span class="string">"plan"</span>: copy.copy(swarms[<span class="number">0</span>].plan)</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">while</span> i_time &lt; self.MAX_TIME:</div><div class="line"></div><div class="line">            <span class="comment"># 首先对于所有的个体进行更新</span></div><div class="line">            <span class="keyword">for</span> bird <span class="keyword">in</span> swarms:</div><div class="line">                bird.fitness = graph.ask_distance_for_plan(bird.plan)</div><div class="line">                <span class="keyword">if</span> bird.fitness &lt; bird.best:</div><div class="line">                    bird.best_plan = copy.copy(bird.plan)</div><div class="line">                    bird.best = bird.fitness</div><div class="line"></div><div class="line">                <span class="keyword">if</span> bird.best &lt; swarm_best[<span class="string">"fitness"</span>]:</div><div class="line">                    swarm_best[<span class="string">"fitness"</span>] = bird.best</div><div class="line">                    swarm_best[<span class="string">"plan"</span>] = copy.copy(bird.plan)</div><div class="line"></div><div class="line">            print(swarm_best)</div><div class="line">            </div><div class="line">            <span class="comment"># 注意这个就是速度更新</span></div><div class="line">            <span class="comment"># 存储的是交换的位置操作以满足不重复性</span></div><div class="line">            <span class="comment"># 同时通过概率的方式方式保存前面的接受常数的概念</span></div><div class="line">            temp_speed = []</div><div class="line"></div><div class="line">            <span class="comment"># 更新每个粒子</span></div><div class="line">            <span class="keyword">for</span> bird <span class="keyword">in</span> swarms:</div><div class="line">                temp_speed.clear()</div><div class="line"></div><div class="line">                <span class="comment"># print(bird.plan)</span></div><div class="line">                <span class="comment"># 设置eta,xi</span></div><div class="line">                <span class="comment"># 这个地方也可以设置乘全局的,也就是粒子群本身的属性中</span></div><div class="line">                eta = <span class="number">0.9</span></div><div class="line">                xi = <span class="number">0.85</span></div><div class="line"></div><div class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</div><div class="line">                    <span class="keyword">if</span> bird.plan[i] != swarm_best[<span class="string">"plan"</span>][i]:</div><div class="line">                        <span class="comment"># 存储的是</span></div><div class="line">                        <span class="comment">#   (i,j,p)</span></div><div class="line">                        <span class="comment">#   i,j,分别表示要交换的位置</span></div><div class="line">                        <span class="comment">#   p表示接受的概率</span></div><div class="line">                        swap_operator = (i, swarm_best[<span class="string">"plan"</span>].index(bird.plan[i]), eta)</div><div class="line">                        temp_speed.append(swap_operator)</div><div class="line">                        u = swap_operator[<span class="number">0</span>]</div><div class="line">                        v = swap_operator[<span class="number">1</span>]</div><div class="line">                        bird.plan[u], bird.plan[v] = bird.plan[v], bird.plan[u]</div><div class="line"></div><div class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</div><div class="line">                    <span class="keyword">if</span> bird.plan[i] != bird.best_plan[i]:</div><div class="line">                        swap_operator = (i, bird.best_plan.index(bird.plan[i]), xi)</div><div class="line">                        temp_speed.append(swap_operator)</div><div class="line">                        u = swap_operator[<span class="number">0</span>]</div><div class="line">                        v = swap_operator[<span class="number">1</span>]</div><div class="line">                        bird.plan[u], bird.plan[v] = bird.plan[v], bird.plan[u]</div><div class="line"></div><div class="line">                <span class="comment"># 下面是用一个随机的变量来判断是否接受交换</span></div><div class="line">                <span class="keyword">for</span> item <span class="keyword">in</span> temp_speed:</div><div class="line">                    rate = random.random()</div><div class="line">                    <span class="keyword">if</span> rate &lt;= item[<span class="number">2</span>]:</div><div class="line">                        u = item[<span class="number">0</span>]</div><div class="line">                        v = item[<span class="number">1</span>]</div><div class="line">                        bird.plan[u], bird.plan[v] = bird.plan[v], bird.plan[u]</div><div class="line"></div><div class="line">                <span class="comment"># 为了保证不会落入到历史最优解中不出来,会给出变异操作,以构造出其他解</span></div><div class="line">                <span class="keyword">if</span> bird.plan == swarm_best[<span class="string">"plan"</span>]:</div><div class="line">                    u = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</div><div class="line">                    v = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</div><div class="line">                    <span class="keyword">while</span> v == u:</div><div class="line">                        v = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</div><div class="line">                    bird.plan[u], bird.plan[v] = bird.plan[v], bird.plan[u]</div><div class="line"></div><div class="line">            i_time += <span class="number">1</span></div><div class="line">        <span class="keyword">return</span> swarm_best</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="4-实验结果"><a href="#4-实验结果" class="headerlink" title="4. 实验结果"></a>4. 实验结果</h3><h4 id="4-1-实验数据"><a href="#4-1-实验数据" class="headerlink" title="4.1 实验数据"></a>4.1 实验数据</h4><p>使用的实验数据如下：<br>给出所有点的坐标<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">A 2.5 4.0</div><div class="line">B 1.2 -2.4</div><div class="line">C 8.7 1.2</div><div class="line">D 3.6 12.1</div><div class="line">E -5.5 0.94</div><div class="line">F -6.6 -12.6</div><div class="line">G 0.18 5.219</div><div class="line">H 12.5 14.3609</div><div class="line">I 22.5 -5.26</div><div class="line">J 1.61 4.5</div><div class="line">K 2.1 -5.6</div><div class="line">L 0 25</div><div class="line">M 9.2 -32</div><div class="line">N -1 7</div><div class="line">O -5 -8</div><div class="line">P 21 35</div><div class="line">Q 16 7.5</div><div class="line">R -21 5</div><div class="line">S -7 -25.5</div><div class="line">T 12 17.5</div></pre></td></tr></table></figure></p>
<p>给出读入数据的python代码：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">graph = Graph(<span class="number">0</span>)</div><div class="line"><span class="keyword">with</span> open(<span class="string">"in.txt"</span>,<span class="string">"r"</span>) <span class="keyword">as</span> f:</div><div class="line">    lines = f.readlines()</div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</div><div class="line">        line = str(line)</div><div class="line">        <span class="comment"># print(line)</span></div><div class="line">        items = line.split(<span class="string">' '</span>)</div><div class="line">        x = float(items[<span class="number">1</span>])</div><div class="line">        y = float(items[<span class="number">2</span>])</div><div class="line">        <span class="comment"># print('x =',x,' y = ',y)</span></div><div class="line">        graph.add_point(Point(x,y))</div></pre></td></tr></table></figure></p>
<h4 id="4-2-实验结果展示"><a href="#4-2-实验结果展示" class="headerlink" title="4.2 实验结果展示"></a>4.2 实验结果展示</h4><p>最终运行的结果:<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;<span class="string">'fitness'</span>: <span class="number">224.6515394977227</span>, <span class="string">'plan'</span>: [<span class="number">5</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">17</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">19</span>, <span class="number">7</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">18</span>]&#125;</div></pre></td></tr></table></figure></p>
<p>也就是有图:</p>
<h4 id="4-2-实验结果分析"><a href="#4-2-实验结果分析" class="headerlink" title="4.2 实验结果分析"></a>4.2 实验结果分析</h4><h5 id="4-2-1迭代次数对于最终结果的影响"><a href="#4-2-1迭代次数对于最终结果的影响" class="headerlink" title="4.2.1迭代次数对于最终结果的影响"></a>4.2.1迭代次数对于最终结果的影响</h5><p>记录生成过程中的结果:</p>
<p>可以看到的是,粒子群在一开始的下降中是非常迅速的.所以在迭代次数相同的状态下,往往粒子群算法会有一个不错的结果.</p>
<h5 id="4-2-2-改变接受率对于最终结果的影响"><a href="#4-2-2-改变接受率对于最终结果的影响" class="headerlink" title="4.2.2 改变接受率对于最终结果的影响"></a>4.2.2 改变接受率对于最终结果的影响</h5><p>在原来的例子中,我们的的接受率取的是固定的$\eta = 0.85,\xi = 0.9$,我们改变这个值的组合:<br>我们分别探究其组合对于其数值的影响.</p>
<p>我们计算如下的集合的结果的组合并绘制三维图像:<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">eta = [<span class="number">0.09</span>, <span class="number">0.19</span>, <span class="number">0.29</span>, <span class="number">0.39</span>, <span class="number">0.49</span>, <span class="number">0.59</span>, <span class="number">0.69</span>, <span class="number">0.79</span>, <span class="number">0.89</span>, <span class="number">0.99</span>]</div><div class="line">xi = [<span class="number">0.09</span>, <span class="number">0.19</span>, <span class="number">0.29</span>, <span class="number">0.39</span>, <span class="number">0.49</span>, <span class="number">0.59</span>, <span class="number">0.69</span>, <span class="number">0.79</span>, <span class="number">0.89</span>, <span class="number">0.99</span>]</div></pre></td></tr></table></figure></p>
<p>最终的结果为:<br>可以看出在向群体最优解方向的更新受限制的时候,结果会出现明显变差的结果,也就是说向群体最优解靠近比向自己的结果靠近在TSP问题中显得更加重要,这也说明了PSO的优越性在于了这两种更新方式的综合</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GeekOrangeLuyao.github.io/src/uncategorized/GA-TSP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="OrangeLuYao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="OrangeLuyao的小站">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/src/uncategorized/GA-TSP/" itemprop="url">GA_TSP</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-10T02:39:22+08:00">
                2018-05-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="遗传算法实验————解决TSP问题"><a href="#遗传算法实验————解决TSP问题" class="headerlink" title="遗传算法实验————解决TSP问题"></a>遗传算法实验————解决TSP问题</h2><blockquote>
<p>本报告使用遗传算法解决TSP问题</p>
</blockquote>
<h3 id="1-实验背景"><a href="#1-实验背景" class="headerlink" title="1. 实验背景"></a>1. 实验背景</h3><p>旅行商问题，即TSP问题（Traveling Salesman Problem），也叫旅行推销员问题、货郎担问题，是数学领域中著名问题之一。假设有一个旅行商人要拜访n个城市，他必须选择所要走的路径，路径的限制是每个城市只能拜访一次，而且最后要回到原来出发的城市。路径的选择目标是要求得的路径路程为所有路径之中的最小值。</p>
<p>旅行推销员问题是图论中最著名的问题之一，即“已给一个n个点的完全图，每条边都有一个长度，求总长度最短的经过每个顶点正好一次的封闭回路”。Edmonds，Cook和Karp等人发现，这批难题有一个值得注意的性质，对其中一个问题存在有效算法时，每个问题都会有有效算法。</p>
<p>迄今为止，这类问题中没有一个找到有效算法。倾向于接受NP完全问题（NP-Complete或NPC）和NP难题（NP-Hard或NPH）不存在有效算法这一猜想，认为这类问题的大型实例不能用精确算法求解，必须寻求这类问题的有效的近似算法。</p>
<h3 id="2-遗传算法"><a href="#2-遗传算法" class="headerlink" title="2. 遗传算法"></a>2. 遗传算法</h3><h4 id="2-1-算法简介"><a href="#2-1-算法简介" class="headerlink" title="2.1 算法简介"></a>2.1 算法简介</h4><p>遗传算法（Genetic Algorithm）是模拟达尔文生物进化论的自然选择和遗传学机理的生物进化过程的计算模型，是一种通过模拟自然进化过程搜索最优解的方法。遗传算法是从代表问题可能潜在的解集的一个种群（population）开始的，而一个种群则由经过基因（gene）编码的一定数目的个体(individual)组成。每个个体实际上是染色体(chromosome)带有特征的实体。染色体作为遗传物质的主要载体，即多个基因的集合，其内部表现（即基因型）是某种基因组合，它决定了个体的形状的外部表现，如黑头发的特征是由染色体中控制这一特征的某种基因组合决定的。因此，在一开始需要实现从表现型到基因型的映射即编码工作。由于仿照基因编码的工作很复杂，我们往往进行简化，如二进制编码，初代种群产生之后，按照适者生存和优胜劣汰的原理，逐代（generation）演化产生出越来越好的近似解，在每一代，根据问题域中个体的适应度（fitness）大小选择（selection）个体，并借助于自然遗传学的遗传算子（genetic operators）进行组合交叉（crossover）和变异（mutation），产生出代表新的解集的种群。这个过程将导致种群像自然进化一样的后生代种群比前代更加适应于环境，末代种群中的最优个体经过解码（decoding），可以作为问题近似最优解。</p>
<p>模拟进化计算（Simulated Evolutionary Computation) 是近二十年来信息科学、人工智能与计算机科学的一大研究领域，由此所派生的求解优化问题的仿生类算法（遗传算法、演化策略、进化程序），由于其鲜明的生物背景、新颖的设计原理、独特的分析方法和成功的应用实践，正日益形成全局搜索与多目标优化理论的一个崭新分支。</p>
<p>遗传算法(GeneticAlgorithm ，GA )是通过模拟生物进化过程来完成优化搜索的，由美国J. Holland 教授提出的一类借鉴生物界自然选择和自然遗传机制的随机化搜索算法。它起源于达尔文的进化论，是模拟达尔文的遗传选择和自然淘汰的生物进化过程的计算模型。其主要特点是群体搜索策略和群体中个体之间的信息交换，搜索不以梯度信息为基础。它尤其适用于处理传统搜索方法难于解决的复杂和非线性问题，可广泛应用于组合优化、机器学习、自适应控制、规划设计和人工生命等领域。作为一种全局优化搜索算法，遗传算法以其简单通用、鲁棒性强、适于并行处理以及应用范围广等特点，使其成为21 世纪智能计算核心技术之一。进入80 年代，遗传算法迎来了兴盛发展时期，无论是理论研究还是应用研究都成了十分热门的话题。</p>
<h4 id="2-2-算法结合TSP"><a href="#2-2-算法结合TSP" class="headerlink" title="2.2 算法结合TSP"></a>2.2 算法结合TSP</h4><ol>
<li><p>种群初始化<br>编码方式为顺序编码，一个种群中包括m个染色体（路线），一条染色体（个体）包含n个基因(城市),还需要的参数是交叉参数和变异参数。</p>
</li>
<li><p>适应度函数<br>计算每一个封闭路线（染色体）的长度作为适应度函数。此时，适应度越小越好。</p>
</li>
<li><p>选择<br>为了使编程简单，可以在迭代过程中保持种群数量m不发生变化，但是为了增加效率，在迭代过程中可以使种群数量发生变化。即每次产生m个新的个体后，将其与之前的个体混在一起，用轮盘赌法选出m个个体进行交叉产生下一代。因此，每一次的迭代都会使种群大小增加m个新的个体。</p>
</li>
<li><p>交叉<br>两个不同个体在对应位置交叉，注意保持交叉之后的个体仍然是1~n的排列。</p>
</li>
<li><p>变异<br>以概率选取个体进行两个基因的交换，这是最简单的办法，而且可以保证一个个体中的基因不会重复。</p>
</li>
</ol>
<h3 id="3-算法设计流程"><a href="#3-算法设计流程" class="headerlink" title="3. 算法设计流程"></a>3. 算法设计流程</h3><h4 id="3-1-算法流程图"><a href="#3-1-算法流程图" class="headerlink" title="3.1 算法流程图"></a>3.1 算法流程图</h4><p>略</p>
<h4 id="3-2-算法实现过程"><a href="#3-2-算法实现过程" class="headerlink" title="3.2 算法实现过程"></a>3.2 算法实现过程</h4><p>使用python3作为设计语言，其中本次使用的版本是python3.6，其中使用了常规的的库有：</p>
<ol>
<li>time</li>
<li>copy</li>
<li>random</li>
<li>math</li>
</ol>
<p>使用的非内置库有：</p>
<ol>
<li>numpy</li>
<li>matplotlib</li>
</ol>
<h5 id="3-2-1-算法设计核心"><a href="#3-2-1-算法设计核心" class="headerlink" title="3.2.1 算法设计核心"></a>3.2.1 算法设计核心</h5><blockquote>
<p>关键在于：</p>
<ol>
<li>变异方式</li>
<li>交叉方式</li>
</ol>
</blockquote>
<ol>
<li><p>交叉方式<br>使用经典的交叉方式，由于对于TSP问题，编码方式需要进行注意，也就是：取父代码的一段编码，随后按照母的顺序将未加入的数值加入，这样的话新的结果实际上对于顺序而言继承的很好。实际上TSP问题就是访问点的顺序问题，因此顺序非常重要。</p>
</li>
<li><p>变异方式<br>变异方式使用最基础的方式：<br>随机两个数据然后交换位置，这样可以方便的保证不会有重复元素</p>
</li>
</ol>
<h5 id="3-2-2-算法设计细节"><a href="#3-2-2-算法设计细节" class="headerlink" title="3.2.2 算法设计细节"></a>3.2.2 算法设计细节</h5><h6 id="3-2-2-1-TSP问题框架"><a href="#3-2-2-1-TSP问题框架" class="headerlink" title="3.2.2.1 TSP问题框架"></a>3.2.2.1 TSP问题框架</h6><p>首先定义点：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x, y)</span>:</span></div><div class="line">        self.x = x</div><div class="line">        self.y = y</div></pre></td></tr></table></figure></p>
<p>然后定义图的数据，注意到<code>ask_distance_for_plan()</code>方法<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Graph</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, n)</span>:</span></div><div class="line">        self.points = []</div><div class="line">        self.point_n = n</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_point</span><span class="params">(self, p)</span>:</span></div><div class="line">        self.points.append(p)</div><div class="line">        self.point_n += <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ask_distance</span><span class="params">(self, i, j)</span>:</span></div><div class="line">        point_x = self.points[i]</div><div class="line">        point_y = self.points[j]</div><div class="line">        <span class="keyword">return</span> math.sqrt(sqr(point_x.x - point_y.x) + sqr(point_x.y - point_y.y))</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ask_distance_for_plan</span><span class="params">(self, plan)</span>:</span></div><div class="line">        res = <span class="number">0.0</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, self.point_n):</div><div class="line">            res += self.ask_distance(plan[i], plan[i - <span class="number">1</span>])</div><div class="line">        res += self.ask_distance(plan[<span class="number">0</span>], plan[self.point_n - <span class="number">1</span>])</div><div class="line">        <span class="comment"># print(plan,' ',res)</span></div><div class="line">        <span class="keyword">return</span> res</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> self.points:</div><div class="line">            print(item.x, <span class="string">" "</span>, item.y)</div></pre></td></tr></table></figure></p>
<h6 id="3-2-2-2-GA细节的设计"><a href="#3-2-2-2-GA细节的设计" class="headerlink" title="3.2.2.2 GA细节的设计"></a>3.2.2.2 GA细节的设计</h6><ol>
<li><p>设置初始值</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 初始化一个序列作为初始数据</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">initPlan</span><span class="params">(self, n)</span>:</span></div><div class="line">    random.seed(time.time())</div><div class="line">    init_plan = []</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n):</div><div class="line">        init_plan.append(i)</div><div class="line"></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</div><div class="line">        j = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</div><div class="line">        <span class="keyword">while</span> i == j:</div><div class="line">            j = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</div><div class="line">        init_plan[i], init_plan[j] = init_plan[j], init_plan[i]</div><div class="line"></div><div class="line">    <span class="keyword">return</span> init_plan</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_group</span><span class="params">(self, n)</span>:</span></div><div class="line">    groups = []</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(self.MAX_GROUP):</div><div class="line">        plan = self.initPlan(n)</div><div class="line">        <span class="keyword">while</span> plan <span class="keyword">in</span> groups:</div><div class="line">            plan = self.initPlan(n)</div><div class="line">        groups.append(plan)</div><div class="line">    <span class="keyword">return</span> groups</div></pre></td></tr></table></figure>
</li>
<li><p>交叉设计</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exchange</span><span class="params">(self, parent1, parent2)</span>:</span></div><div class="line">    index1 = random.randint(<span class="number">0</span>, len(parent1) - <span class="number">1</span>)</div><div class="line">    index2 = random.randint(index1, len(parent1) - <span class="number">1</span>)</div><div class="line">    tempGene = parent2[index1:index2]  <span class="comment"># 交叉的基因片段</span></div><div class="line">    newGene = []</div><div class="line">    p1len = <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> g <span class="keyword">in</span> parent1:</div><div class="line">        <span class="keyword">if</span> p1len == index1:</div><div class="line">            <span class="comment"># 插入基因片段</span></div><div class="line">            newGene.extend(tempGene)  </div><div class="line">            p1len += <span class="number">1</span></div><div class="line">        <span class="keyword">if</span> g <span class="keyword">not</span> <span class="keyword">in</span> tempGene:</div><div class="line">            newGene.append(g)</div><div class="line">            p1len += <span class="number">1</span></div><div class="line">    <span class="keyword">return</span> newGene</div></pre></td></tr></table></figure>
</li>
<li><p>变异设计</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">mutate</span><span class="params">(self, list_x)</span>:</span></div><div class="line">    random.seed(time.time())</div><div class="line">    n = len(list_x)</div><div class="line">    u = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</div><div class="line">    v = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</div><div class="line">    <span class="keyword">while</span> v == u:</div><div class="line">        v = random.randint(<span class="number">0</span>, n - <span class="number">1</span>)</div><div class="line">    list_x[u], list_x[v] = list_x[v], list_x[u]</div><div class="line">    <span class="keyword">return</span> list_xs</div></pre></td></tr></table></figure>
</li>
<li><p>关于排序<br>在代码中保留一个排序的位置，但是排序对于当前的设计中效果不是很明显，基于对于速度的考虑，并没有调用这个函数</p>
</li>
<li><p>整合<br>最终整合出的代码，给出核心的<code>run()</code>方法</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self, n, graph)</span>:</span></div><div class="line">    <span class="comment"># n is the size of each individual</span></div><div class="line">    init_group = self.init_group(n)</div><div class="line">    <span class="comment"># init_group = self.sort_group(init_group, graph)</span></div><div class="line">    i_time = <span class="number">0</span></div><div class="line">    best_ans = &#123;</div><div class="line">        <span class="string">"fitness"</span>: graph.ask_distance_for_plan(init_group[<span class="number">0</span>]),</div><div class="line">        <span class="string">"plan"</span>: init_group[<span class="number">0</span>]</div><div class="line">    &#125;</div><div class="line">    print(init_group)</div><div class="line">    ans_each = []</div><div class="line">    <span class="keyword">while</span> i_time &lt; self.MAX_TIME:</div><div class="line">        print(best_ans)</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.MAX_GROUP):</div><div class="line">            <span class="keyword">if</span> random.random() &lt; self.EXCHANGE_RATE:</div><div class="line">                j = random.randint(<span class="number">0</span>, self.MAX_GROUP - <span class="number">1</span>)</div><div class="line">                <span class="keyword">while</span> i == j:</div><div class="line">                    j = random.randint(<span class="number">0</span>, self.MAX_GROUP - <span class="number">1</span>)</div><div class="line">                new_plan = self.exchange(init_group[i], init_group[j])</div><div class="line">                init_group[i] = copy.copy(new_plan)</div><div class="line"></div><div class="line">            <span class="keyword">if</span> random.random() &lt; self.MUTE_RATE:</div><div class="line">                init_group[i] = self.mutate(init_group[i])</div><div class="line"></div><div class="line">            <span class="keyword">if</span> graph.ask_distance_for_plan(init_group[i]) &lt; best_ans[<span class="string">"fitness"</span>]:</div><div class="line">                best_ans[<span class="string">"fitness"</span>] = graph.ask_distance_for_plan(init_group[i])</div><div class="line">                best_ans[<span class="string">"plan"</span>] = copy.copy(init_group[i])</div><div class="line"></div><div class="line">        ans_each.append(best_ans[<span class="string">"fitness"</span>])</div><div class="line">        i_time += <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="keyword">return</span> best_ans,ans_each</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="4-实验结果"><a href="#4-实验结果" class="headerlink" title="4. 实验结果"></a>4. 实验结果</h3><h4 id="4-1-实验数据"><a href="#4-1-实验数据" class="headerlink" title="4.1 实验数据"></a>4.1 实验数据</h4><p>使用的实验数据如下：<br>给出所有点的坐标<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">A 2.5 4.0</div><div class="line">B 1.2 -2.4</div><div class="line">C 8.7 1.2</div><div class="line">D 3.6 12.1</div><div class="line">E -5.5 0.94</div><div class="line">F -6.6 -12.6</div><div class="line">G 0.18 5.219</div><div class="line">H 12.5 14.3609</div><div class="line">I 22.5 -5.26</div><div class="line">J 1.61 4.5</div><div class="line">K 2.1 -5.6</div><div class="line">L 0 25</div><div class="line">M 9.2 -32</div><div class="line">N -1 7</div><div class="line">O -5 -8</div><div class="line">P 21 35</div><div class="line">Q 16 7.5</div><div class="line">R -21 5</div><div class="line">S -7 -25.5</div><div class="line">T 12 17.5</div></pre></td></tr></table></figure></p>
<p>给出读入数据的python代码：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">graph = Graph(<span class="number">0</span>)</div><div class="line"><span class="keyword">with</span> open(<span class="string">"in.txt"</span>,<span class="string">"r"</span>) <span class="keyword">as</span> f:</div><div class="line">    lines = f.readlines()</div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</div><div class="line">        line = str(line)</div><div class="line">        <span class="comment"># print(line)</span></div><div class="line">        items = line.split(<span class="string">' '</span>)</div><div class="line">        x = float(items[<span class="number">1</span>])</div><div class="line">        y = float(items[<span class="number">2</span>])</div><div class="line">        <span class="comment"># print('x =',x,' y = ',y)</span></div><div class="line">        graph.add_point(Point(x,y))</div></pre></td></tr></table></figure></p>
<h4 id="4-2-实验结果展示"><a href="#4-2-实验结果展示" class="headerlink" title="4.2 实验结果展示"></a>4.2 实验结果展示</h4><p>最终运行的结果如下：</p>
<p>这是迭代1000，种群数为1000的结果：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;<span class="string">'fitness'</span>: <span class="number">301.1644602573964</span>, <span class="string">'plan'</span>: [<span class="number">5</span>, <span class="number">17</span>, <span class="number">3</span>, <span class="number">19</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">0</span>]&#125;</div></pre></td></tr></table></figure></p>
<p>GA算法在这种参数结构下，对于实际结果还是比较接近的。</p>
<h4 id="4-2-实验结果分析"><a href="#4-2-实验结果分析" class="headerlink" title="4.2 实验结果分析"></a>4.2 实验结果分析</h4><ol>
<li><p>记录迭代中的结果<br>我们记录迭代过程中的结果，这个结果同时可以表示在相同种群数下，迭代次数的增加对于最终结果的影响：可以看到一开始的降落十分迅速，一直到最后趋于稳定</p>
</li>
<li><p>种群数对于结果的影响<br>我们修改种群数对于最终解的结果：可以看到基本上是一个下降的过程。中间差别不是很大的有所摇摆。</p>
</li>
<li><p>变异率的影响<br>如果我们改变变异率，最终结果的变化如下：<br>其中我们选择的数据：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="number">0.0</span>, <span class="number">0.05</span>, <span class="number">0.1</span>, <span class="number">0.15</span>, <span class="number">0.2</span>, <span class="number">0.25</span>, <span class="number">0.3</span>, <span class="number">0.35</span>, <span class="number">0.4</span>, <span class="number">0.45</span>, <span class="number">0.5</span>, <span class="number">0.55</span>, <span class="number">0.6</span>, <span class="number">0.65</span>, <span class="number">0.7</span>, <span class="number">0.75</span>, <span class="number">0.8</span>, <span class="number">0.85</span>, <span class="number">0.9</span>, <span class="number">0.95</span>]</div></pre></td></tr></table></figure>
</li>
</ol>
<p>可以看到结果还是比较不稳定的，这也可以看出这种mute方式，由于强行更换顺序，所以效果不尽如人意的结果</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GeekOrangeLuyao.github.io/src/uncategorized/ACO-TSP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="OrangeLuYao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="OrangeLuyao的小站">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/src/uncategorized/ACO-TSP/" itemprop="url">ACO_TSP</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-10T02:35:53+08:00">
                2018-05-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="蚁群算法实验————解决TSP问题"><a href="#蚁群算法实验————解决TSP问题" class="headerlink" title="蚁群算法实验————解决TSP问题"></a>蚁群算法实验————解决TSP问题</h2><blockquote>
<p>本报告使用蚁群算法解决TSP问题</p>
</blockquote>
<h3 id="1-实验背景"><a href="#1-实验背景" class="headerlink" title="1. 实验背景"></a>1. 实验背景</h3><p>旅行商问题，即TSP问题（Traveling Salesman Problem），也叫旅行推销员问题、货郎担问题，是数学领域中著名问题之一。假设有一个旅行商人要拜访n个城市，他必须选择所要走的路径，路径的限制是每个城市只能拜访一次，而且最后要回到原来出发的城市。路径的选择目标是要求得的路径路程为所有路径之中的最小值。</p>
<p>旅行推销员问题是图论中最著名的问题之一，即“已给一个n个点的完全图，每条边都有一个长度，求总长度最短的经过每个顶点正好一次的封闭回路”。Edmonds，Cook和Karp等人发现，这批难题有一个值得注意的性质，对其中一个问题存在有效算法时，每个问题都会有有效算法。</p>
<p>迄今为止，这类问题中没有一个找到有效算法。倾向于接受NP完全问题（NP-Complete或NPC）和NP难题（NP-Hard或NPH）不存在有效算法这一猜想，认为这类问题的大型实例不能用精确算法求解，必须寻求这类问题的有效的近似算法。</p>
<h3 id="2-蚁群算法"><a href="#2-蚁群算法" class="headerlink" title="2. 蚁群算法"></a>2. 蚁群算法</h3><h4 id="2-1-蚁群算法简介"><a href="#2-1-蚁群算法简介" class="headerlink" title="2.1 蚁群算法简介"></a>2.1 蚁群算法简介</h4><p>蚁群系统(Ant System或Ant Colony System)是由意大利学者Dorigo、Maniezzo等人于20世纪90年代首先提出来的。他们在研究蚂蚁觅食的过程中，发现单个蚂蚁的行为比较简单，但是蚁群整体却可以体现一些智能的行为。例如蚁群可以在不同的环境下，寻找最短到达食物源的路径。这是因为蚁群内的蚂蚁可以通过某种信息机制实现信息的传递。后又经进一步研究发现，蚂蚁会在其经过的路径上释放一种可以称之为“信息素”的物质，蚁群内的蚂蚁对“信息素”具有感知能力，它们会沿着“信息素”浓度较高路径行走，而每只路过的蚂蚁都会在路上留下“信息素”，这就形成一种类似正反馈的机制，这样经过一段时间后，整个蚁群就会沿着最短路径到达食物源了。</p>
<p>将蚁群算法应用于解决优化问题的基本思路为：用蚂蚁的行走路径表示待优化问题的可行解，整个蚂蚁群体的所有路径构成待优化问题的解空间。路径较短的蚂蚁释放的信息素量较多，随着时间的推进，较短的路径上累积的信息素浓度逐渐增高，选择该路径的蚂蚁个数也愈来愈多。最终，整个蚂蚁会在正反馈的作用下集中到最佳的路径上，此时对应的便是待优化问题的最优解。</p>
<h4 id="2-2-蚁群算法结合TSP"><a href="#2-2-蚁群算法结合TSP" class="headerlink" title="2.2 蚁群算法结合TSP"></a>2.2 蚁群算法结合TSP</h4><p>控制蚁群算法走向的关键是信息素，信息素类似遗传算法的适应性函数，类似退火算法的评价函数，影响着其中一只蚂蚁的下一步的选择。</p>
<ol>
<li>蚂蚁：类似遗传算法的染色体，就是一条解，在tsp问题中蚂蚁的路径就是tsp的解。</li>
<li>信息素：评价函数，与路径成反比</li>
<li>蚂蚁数量：一次迭代有多少只蚂蚁在跑（注意不是一起跑，而是先后放上一只蚂蚁）</li>
<li>迭代次数T：所有蚂蚁跑完视为一次迭代周期。</li>
</ol>
<h3 id="3-算法设计流程"><a href="#3-算法设计流程" class="headerlink" title="3. 算法设计流程"></a>3. 算法设计流程</h3><h4 id="3-1-算法实现过程"><a href="#3-1-算法实现过程" class="headerlink" title="3.1 算法实现过程"></a>3.1 算法实现过程</h4><p>使用python3作为设计语言，其中本次使用的版本是python3.6，其中使用了常规的的库有：</p>
<ol>
<li>time</li>
<li>copy</li>
<li>random</li>
<li>math</li>
</ol>
<p>使用的非内置库有：</p>
<ol>
<li>numpy</li>
<li>matplotlib</li>
</ol>
<h5 id="3-1-1-算法公式"><a href="#3-1-1-算法公式" class="headerlink" title="3.1.1 算法公式"></a>3.1.1 算法公式</h5><blockquote>
<p>在算法中使用的中重要公式有：</p>
<ol>
<li>计算信息量</li>
<li>信息量更新</li>
</ol>
</blockquote>
<h6 id="3-1-1-1-计算信息量"><a href="#3-1-1-1-计算信息量" class="headerlink" title="3.1.1.1 计算信息量"></a>3.1.1.1 计算信息量</h6><p>计算信息量<br>$$P<em>{ij}^k(t) = \frac{\tau</em>{ij}^\alpha(t)\eta<em>{ij}^{\beta}(t)}{\sum</em>{l \in A<em>k}\tau</em>{il}^\alpha(t)\eta_{il}^{\beta}(t)}$$<br>其中:</p>
<ol>
<li>$P_{ij}^k$表示蚂蚁选择的概率</li>
<li>$A_k$第k个蚂蚁的可到达集合</li>
<li>$\eta<em>{ij} = \frac{1}{d</em>{ij}}$,$d_{ij}$表示图上两点距离</li>
<li>$\tau_{ij}$表示信息素</li>
</ol>
<h6 id="3-1-1-2-信息量更新"><a href="#3-1-1-2-信息量更新" class="headerlink" title="3.1.1.2 信息量更新"></a>3.1.1.2 信息量更新</h6><p>信息量的更新</p>
<ol>
<li>信息量计算<br>$$\tau<em>{ij}(t+n) = (1 - \rho)\tau</em>{ij}(t) + \Delta\tau_{ij}(t)$$</li>
<li>蚂蚁提供的信息量<br>$$\Delta\tau<em>{ij}(t) = \sum</em>{k=1}^{M}\Delta\tau_{ij}^k(t)$$</li>
</ol>
<h5 id="3-1-2-算法设计"><a href="#3-1-2-算法设计" class="headerlink" title="3.1.2 算法设计"></a>3.1.2 算法设计</h5><ol>
<li>图类<br>首先给出一个单点的类：<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,x,y)</span>:</span></div><div class="line">        self.x = x</div><div class="line">        self.y = y</div></pre></td></tr></table></figure>
</li>
</ol>
<p>再给出图的类，保存所有的点，对于每个序列可以判断结果<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Graph</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,n)</span>:</span></div><div class="line">        self.points = []</div><div class="line">        self.point_n = n</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_point</span><span class="params">(self,p)</span>:</span></div><div class="line">        self.points.append(p)</div><div class="line">        self.point_n += <span class="number">1</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ask_distance</span><span class="params">(self,i,j)</span>:</span></div><div class="line">        point_x = self.points[i]</div><div class="line">        point_y = self.points[j]</div><div class="line">        <span class="keyword">return</span> math.sqrt(sqr(point_x.x - point_y.x) + sqr(point_x.y - point_y.y))</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ask_distance_for_plan</span><span class="params">(self,plan)</span>:</span></div><div class="line">        res = <span class="number">0.0</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,self.point_n):</div><div class="line">            res += self.ask_distance(plan[i],plan[i<span class="number">-1</span>])</div><div class="line">        res += self.ask_distance(plan[<span class="number">0</span>],plan[self.point_n<span class="number">-1</span>])</div><div class="line">        <span class="keyword">return</span> res</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> self.points:</div><div class="line">            print(item.x,<span class="string">" "</span>,item.y)</div></pre></td></tr></table></figure></p>
<ol>
<li>单体蚂蚁设计<br>每个单体蚂蚁需要有如下属性：<blockquote>
<ol>
<li>当前所在城市</li>
<li>走过的路径</li>
<li>已经走过的路径的个数</li>
</ol>
</blockquote>
</li>
</ol>
<p>对应的python代码是：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ant</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,cur_city,city_n)</span>:</span></div><div class="line">        self.city = cur_city</div><div class="line">        self.tabu_table = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(city_n)]</div><div class="line">        self.tabu_table[self.city] = <span class="number">1</span></div><div class="line">        self.city_cnt = <span class="number">1</span></div></pre></td></tr></table></figure></p>
<ol>
<li>算法实例类<br>最核心的部分就是<code>run()</code>方法，是整个算法的主题</li>
</ol>
<p>根据前面给出的流程图，同时还需要初始化函数。</p>
<p>首先定义一些重要的常数：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,ant_n,max_time)</span>:</span></div><div class="line">    self.MAX_TIME = max_time</div><div class="line">    self.ant_n = ant_n</div><div class="line">    self.alpha = DEFAULT_ALPHA</div><div class="line">    self.beta = DEFAULT_BETA</div><div class="line">    self.rou = DEFAULT_ROU</div><div class="line">    self.Q = DEFAULT_Q</div></pre></td></tr></table></figure></p>
<p>其中</p>
<ul>
<li>MAX_TIME是最大迭代次数</li>
<li>ant_n 是蚁群数量</li>
<li>alpha,beta是幂次常数</li>
<li>rou是信息量留存率</li>
<li>Q是蚂蚁信息量流动</li>
</ul>
<p><strong>注意：使用的是蚁密模型，所以Q不变化</strong></p>
<p>随后进行蚁群的初始化，对于每一个蚂蚁随机其位置<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_ants</span><span class="params">(self,city_n)</span>:</span></div><div class="line">    random.seed(time.time())</div><div class="line">    ants = []</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(self.ant_n):</div><div class="line">        ants.append(Ant(random.randint(<span class="number">0</span>,city_n<span class="number">-1</span>),city_n))</div><div class="line">    <span class="keyword">return</span> ants</div></pre></td></tr></table></figure></p>
<p>随后初始化信息量,初始所有信息量为1.0<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_info</span><span class="params">(self,n)</span>:</span></div><div class="line">    info = [[<span class="number">1.0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(n)] <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</div><div class="line">    <span class="keyword">return</span> info</div></pre></td></tr></table></figure></p>
<p>最后就是算法实体了，给出核心代码，算法细节参见其中的注释<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self,n,graph)</span>:</span></div><div class="line">    random.seed(time.time())</div><div class="line">    </div><div class="line">    <span class="comment"># 初始化参数</span></div><div class="line">    city_n = n</div><div class="line">    i_time = <span class="number">0</span></div><div class="line">    info = self.init_info(n)</div><div class="line">    new_info = copy.copy(info)</div><div class="line">    ants = self.init_ants(n)</div><div class="line"></div><div class="line">    init_plan = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(city_n)]</div><div class="line">    better_res = &#123;</div><div class="line">            <span class="string">"fitness"</span>: graph.ask_distance_for_plan(init_plan),</div><div class="line">            <span class="string">"plan"</span>: init_plan</div><div class="line">        &#125;</div><div class="line">    <span class="comment"># 迭代开始</span></div><div class="line">    print(<span class="string">"start algorithm"</span>)</div><div class="line"></div><div class="line">    <span class="keyword">while</span> i_time &lt; self.MAX_TIME:</div><div class="line">        info = copy.copy(new_info)</div><div class="line">        </div><div class="line">        <span class="comment"># 对于每一个城市的连接，进行信息衰减</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(city_n):</div><div class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(city_n):</div><div class="line">                <span class="keyword">if</span> i == j:</div><div class="line">                    <span class="keyword">continue</span></div><div class="line">                <span class="keyword">else</span>:</div><div class="line">                    new_info[i][j] *= (<span class="number">1</span> - self.rou)</div><div class="line">        </div><div class="line">        <span class="comment"># 对于每一只蚂蚁个体进行操作</span></div><div class="line">        <span class="keyword">for</span> ant <span class="keyword">in</span> ants:</div><div class="line">            city_i = ant.city</div><div class="line">            p_max = <span class="number">0.0</span></div><div class="line">            city_max = city_i</div><div class="line">            </div><div class="line">            <span class="keyword">for</span> city <span class="keyword">in</span> range(city_n):</div><div class="line">                <span class="comment"># 查看每个城市这只蚂蚁是否还可以继续走</span></div><div class="line">                <span class="keyword">if</span> ant.tabu_table[city] != <span class="number">0</span>:</div><div class="line">                    <span class="keyword">continue</span></div><div class="line">                <span class="keyword">else</span>:</div><div class="line">                    <span class="comment"># 根据公式进行计算新的出发概率</span></div><div class="line">                    <span class="comment"># 记录概率最大的路径</span></div><div class="line">                    p = math.pow(info[city_i][city],self.alpha)</div><div class="line">                    p *= math.pow((<span class="number">1.0</span> / graph.ask_distance(city_i,city)),self.beta)</div><div class="line">                    <span class="keyword">if</span> p_max &lt; p:</div><div class="line">                        p_max = p</div><div class="line">                        city_max = city</div><div class="line">            </div><div class="line">            <span class="comment"># 将这只蚂蚁进行实际的行走，并改变这条路的信息量</span></div><div class="line">            new_info[city_i][city_max] += self.Q</div><div class="line">            ant.city_cnt += <span class="number">1</span></div><div class="line">            ant.tabu_table[city_max] = ant.city_cnt</div><div class="line">            ant.city = city_max</div><div class="line"></div><div class="line"></div><div class="line">            <span class="keyword">if</span> ant.city_cnt == city_n:</div><div class="line">                print(ant.city)</div><div class="line">                print(ant.tabu_table)</div><div class="line">                plan = []</div><div class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> range(city_n):</div><div class="line">                    <span class="keyword">for</span> j <span class="keyword">in</span> range(city_n):</div><div class="line">                        <span class="keyword">if</span> i + <span class="number">1</span> == ant.tabu_table[j]:</div><div class="line">                            plan.append(j)</div><div class="line">                            <span class="keyword">break</span></div><div class="line">                <span class="comment"># 如果当前蚂蚁走完了所有的道路，那么统计以此大难</span></div><div class="line">                <span class="keyword">if</span> better_res[<span class="string">"fitness"</span>] &gt; graph.ask_distance_for_plan(plan):</div><div class="line">                    better_res[<span class="string">"fitness"</span>] = graph.ask_distance_for_plan(plan)</div><div class="line">                    better_res[<span class="string">"plan"</span>] = copy.copy(plan)</div><div class="line">        </div><div class="line">        <span class="comment"># 迭代次数+1</span></div><div class="line">        i_time += <span class="number">1</span></div><div class="line">    </div><div class="line">    <span class="comment"># 最终输出最好的解</span></div><div class="line">    print(better_res)</div></pre></td></tr></table></figure></p>
<h3 id="4-实验结果"><a href="#4-实验结果" class="headerlink" title="4. 实验结果"></a>4. 实验结果</h3><h4 id="4-1-实验数据"><a href="#4-1-实验数据" class="headerlink" title="4.1 实验数据"></a>4.1 实验数据</h4><p>使用的实验数据如下：<br>给出所有点的坐标<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">A 2.5 4.0</div><div class="line">B 1.2 -2.4</div><div class="line">C 8.7 1.2</div><div class="line">D 3.6 12.1</div><div class="line">E -5.5 0.94</div><div class="line">F -6.6 -12.6</div><div class="line">G 0.18 5.219</div><div class="line">H 12.5 14.3609</div><div class="line">I 22.5 -5.26</div><div class="line">J 1.61 4.5</div><div class="line">K 2.1 -5.6</div><div class="line">L 0 25</div><div class="line">M 9.2 -32</div><div class="line">N -1 7</div><div class="line">O -5 -8</div><div class="line">P 21 35</div><div class="line">Q 16 7.5</div><div class="line">R -21 5</div><div class="line">S -7 -25.5</div><div class="line">T 12 17.5</div></pre></td></tr></table></figure></p>
<p>给出读入数据的python代码：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">graph = Graph(<span class="number">0</span>)</div><div class="line"><span class="keyword">with</span> open(<span class="string">"in.txt"</span>,<span class="string">"r"</span>) <span class="keyword">as</span> f:</div><div class="line">    lines = f.readlines()</div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</div><div class="line">        line = str(line)</div><div class="line">        <span class="comment"># print(line)</span></div><div class="line">        items = line.split(<span class="string">' '</span>)</div><div class="line">        x = float(items[<span class="number">1</span>])</div><div class="line">        y = float(items[<span class="number">2</span>])</div><div class="line">        <span class="comment"># print('x =',x,' y = ',y)</span></div><div class="line">        graph.add_point(Point(x,y))</div></pre></td></tr></table></figure></p>
<h4 id="4-2-实验结果展示"><a href="#4-2-实验结果展示" class="headerlink" title="4.2 实验结果展示"></a>4.2 实验结果展示</h4><p>使用代码进行运算之后，给出的方案如下：</p>
<p>方案结果：<br>plan 属性就是行走的序列<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&#123;<span class="string">'fitness'</span>: <span class="number">236.00533690946466</span></div><div class="line"> <span class="string">'plan'</span>: [<span class="number">7</span>, <span class="number">19</span>, <span class="number">3</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">18</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">15</span>]&#125;</div></pre></td></tr></table></figure></p>
<p>在蚂蚁群体为1000，迭代次数为2000的时候，运行时间大概是7.311997413635254s，（时间不包括构建图的时间）</p>
<p>最终运行结果统计：考虑到随机性，这个时候多次运行就是必要的了。我们随机20次之后，平均的结果是：232.55980133891256</p>
<h4 id="4-2-实验结果分析"><a href="#4-2-实验结果分析" class="headerlink" title="4.2 实验结果分析"></a>4.2 实验结果分析</h4><h5 id="4-2-1-稳定性"><a href="#4-2-1-稳定性" class="headerlink" title="4.2.1 稳定性"></a>4.2.1 稳定性</h5><p>在多次运行的情况下的结果：<br>在这个情况下：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">aco = ACO(<span class="number">100</span>,<span class="number">2000</span>)</div></pre></td></tr></table></figure></p>
<p>运行结果是（由于是组合问题，从而是同样的问题）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">236.00533690946466</div><div class="line">236.00533690946466 </div><div class="line">236.00533690946466 </div><div class="line">232.5598013389125 </div><div class="line">232.5598013389125 </div><div class="line">232.5598013389125 </div><div class="line">240.61174671394733 </div><div class="line">232.5598013389125 </div><div class="line">239.12791725285265 </div><div class="line">232.5598013389125 </div><div class="line">232.5598013389125 </div><div class="line">232.5598013389125 </div><div class="line">236.00533690946466 </div><div class="line">232.5598013389125 </div><div class="line">237.101406422663 </div><div class="line">232.5598013389125 </div><div class="line">232.5598013389125 </div><div class="line">232.5598013389125 </div><div class="line">232.5598013389125 </div><div class="line">232.5598013389125</div></pre></td></tr></table></figure></p>
<p>可以看到最终的结果是非常稳定的</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GeekOrangeLuyao.github.io/src/uncategorized/Vim 配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="OrangeLuYao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="OrangeLuyao的小站">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/src/uncategorized/Vim 配置/" itemprop="url">Vim 配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-22T22:31:48+08:00">
                2018-04-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Linux-Vim-配置"><a href="#Linux-Vim-配置" class="headerlink" title=" Linux Vim 配置 "></a><a href="https://blog.csdn.net/kissacm/article/details/78349287" target="_blank" rel="external"> Linux Vim 配置 </a></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line">&quot; All system-wide defaults are set in $VIMRUNTIME/debian.vim and sourced by</div><div class="line">&quot; the call to :runtime you can find below.  If you wish to change any of those</div><div class="line">&quot; settings, you should do it in this file (/etc/vim/vimrc), since debian.vim</div><div class="line">&quot; will be overwritten everytime an upgrade of the vim packages is performed.</div><div class="line">&quot; It is recommended to make changes after sourcing debian.vim since it alters</div><div class="line">&quot; the value of the &apos;compatible&apos; option.</div><div class="line"></div><div class="line">&quot; This line should not be removed as it ensures that various options are</div><div class="line">&quot; properly set to work with the Vim-related packages available in Debian.</div><div class="line">runtime! debian.vim</div><div class="line"></div><div class="line">&quot; Uncomment the next line to make Vim more Vi-compatible</div><div class="line">&quot; NOTE: debian.vim sets &apos;nocompatible&apos;.  Setting &apos;compatible&apos; changes numerous</div><div class="line">&quot; options, so any other options should be set AFTER setting &apos;compatible&apos;.</div><div class="line">&quot;set compatible</div><div class="line"></div><div class="line">&quot; Vim5 and later versions support syntax highlighting. Uncommenting the next</div><div class="line">&quot; line enables syntax highlighting by default.</div><div class="line">if has(&quot;syntax&quot;)</div><div class="line">  syntax on</div><div class="line">endif</div><div class="line"></div><div class="line">&quot; If using a dark background within the editing area and syntax highlighting</div><div class="line">&quot; turn on this option as well</div><div class="line">set background=dark</div><div class="line"></div><div class="line">&quot; Uncomment the following to have Vim jump to the last position when</div><div class="line">&quot; reopening a file</div><div class="line">&quot;if has(&quot;autocmd&quot;)</div><div class="line">&quot;  au BufReadPost * if line(&quot;&apos;\&quot;&quot;) &gt; 1 &amp;&amp; line(&quot;&apos;\&quot;&quot;) &lt;= line(&quot;$&quot;) | exe &quot;normal! g&apos;\&quot;&quot; | endif</div><div class="line">&quot;endif</div><div class="line"></div><div class="line">&quot; Uncomment the following to have Vim load indentation rules and plugins</div><div class="line">&quot; according to the detected filetype.</div><div class="line">&quot;if has(&quot;autocmd&quot;)</div><div class="line">&quot;  filetype plugin indent on</div><div class="line">&quot;endif</div><div class="line"></div><div class="line">&quot; The following are commented out as they cause vim to behave a lot</div><div class="line">&quot; differently from regular Vi. They are highly recommended though.</div><div class="line">&quot;set showcmd        &quot; Show (partial) command in status line.</div><div class="line">&quot;set showmatch      &quot; Show matching brackets.</div><div class="line">&quot;set ignorecase     &quot; Do case insensitive matching</div><div class="line">&quot;set smartcase      &quot; Do smart case matching</div><div class="line">&quot;set incsearch      &quot; Incremental search</div><div class="line">&quot;set autowrite      &quot; Automatically save before commands like :next and :make</div><div class="line">&quot;set hidden     &quot; Hide buffers when they are abandoned</div><div class="line">&quot;set mouse=a        &quot; Enable mouse usage (all modes)</div><div class="line"></div><div class="line">&quot; Source a global configuration file if available</div><div class="line">if filereadable(&quot;/etc/vim/vimrc.local&quot;)</div><div class="line">  source /etc/vim/vimrc.local</div><div class="line">endif</div><div class="line"></div><div class="line">set ai                          &quot; 自动缩进，新行与前面的行保持—致的自动空格</div><div class="line">set aw                        &quot; 自动写，转入shell或使用：n编辑其他文件时，当前的缓冲区被写入</div><div class="line">set flash                     &quot; 在出错处闪烁但不呜叫(缺省)</div><div class="line">set ic                          &quot; 在查询及模式匹配时忽赂大小写</div><div class="line">set nu        </div><div class="line">set number                &quot; 屏幕左边显示行号</div><div class="line">set showmatch          &quot; 显示括号配对，当键入“]”“)”时，高亮度显示匹配的括号</div><div class="line">set showmode           &quot; 处于文本输入方式时加亮按钮条中的模式指示器</div><div class="line">set showcmd             &quot; 在状态栏显示目前所执行的指令，未完成的指令片段亦会显示出来</div><div class="line">set warn        &quot; 对文本进行了新的修改后，离开shell时系统给出显示(缺省)</div><div class="line">set ws               &quot; 在搜索时如到达文件尾则绕回文件头继续搜索</div><div class="line">set wrap        &quot; 长行显示自动折行</div><div class="line">colorscheme ron &quot; 设定背景</div><div class="line">filetype plugin on        &quot; 自动识别文件类型，自动匹配对应的, “文件类型Plugin.vim”文件，使用缩进定义文件</div><div class="line">set autoindent            &quot; 设置自动缩进：即每行的缩进值与上一行相等；使用 noautoindent 取消设置</div><div class="line">set cindent                 &quot; 以C/C++的模式缩进</div><div class="line">set noignorecase       &quot; 默认区分大小写</div><div class="line">set ruler                     &quot; 打开状态栏标尺</div><div class="line">set scrolloff=5            &quot; 设定光标离窗口上下边界 5 行时窗口自动滚动</div><div class="line">set shiftwidth=4          &quot; 设定 &lt;&lt; 和 &gt;&gt; 命令移动时的宽度为 4</div><div class="line">set softtabstop=4       &quot; 使得按退格键时可以一次删掉 4 个空格,不足 4 个时删掉所有剩下的空格）</div><div class="line">set tabstop=4             &quot; 设定 tab 长度为 4</div><div class="line">set wrap                     &quot; 自动换行显示</div><div class="line">syntax enable</div><div class="line">syntax on                    &quot; 自动语法高亮</div><div class="line">inoremap ( ()&lt;ESC&gt;i</div><div class="line">inoremap [ []&lt;ESC&gt;i</div><div class="line">inoremap &#123; &#123;&#125;&lt;ESC&gt;i</div><div class="line">inoremap &quot; &quot;&quot;&lt;ESC&gt;i</div><div class="line">inoremap &apos; &apos;&apos;&lt;ESC&gt;i</div><div class="line">inoremap &#123; &#123;&lt;CR&gt;&#125;&lt;ESC&gt;kA&lt;CR&gt;</div></pre></td></tr></table></figure>
<p>想更换VIM配色打朋友可以查看自己vim<em>/colors，下面打 ` </em>.vim ` 文件即可更改对应的主题。</p>
<p>虽然很好用，可是我用SpaceVim，(逃…</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="OrangeLuYao" />
          <p class="site-author-name" itemprop="name">OrangeLuYao</p>
           
              <p class="site-description motion-element" itemprop="description">深自缄默，如云漂泊</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">193</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">76</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="mailto:OrangeLuyao@outlook.com" target="_blank" title="E-Mail">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  E-Mail
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://space.bilibili.com/36409945/#/" target="_blank" title="Bilibili">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Bilibili
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/leo-40-71/activities" target="_blank" title="Zhihu">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Zhihu
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-block">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              My Other Blogs
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://blog.csdn.net/kissacm" title="CSDN" target="_blank">CSDN</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://geekvitaminc.github.io/" title="GeekVitaminC" target="_blank">GeekVitaminC</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">OrangeLuYao</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
